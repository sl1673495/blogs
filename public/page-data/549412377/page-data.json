{"componentChunkName":"component---src-templates-blog-post-js","path":"/549412377/","result":{"data":{"site":{"siteMetadata":{"title":"sshçš„åšå®¢","author":"ssh"}},"markdownRemark":{"id":"059ca329-730c-53c4-a927-6d207849c28a","html":"<p>ä¹‹å‰å‡ ç¯‡è®²TypeScriptçš„æ–‡ç« ä¸­ï¼Œæˆ‘å¸¦æ¥äº†åœ¨Reactä¸­çš„ä¸€äº›å°å®è·µ  </p>\n<p><a href=\"https://juejin.im/post/5dddde68e51d4541c24658c1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">React + TypeScript + Hook å¸¦ä½ æ‰‹æŠŠæ‰‹æ‰“é€ ç±»å‹å®‰å…¨çš„åº”ç”¨ã€‚</a>  </p>\n<p><a href=\"https://juejin.im/post/5df1ede4f265da33ec7db049\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">React Hook + TypeScript æ‰‹æŠŠæ‰‹å¸¦ä½ æ‰“é€ use-watchè‡ªå®šä¹‰Hookï¼Œå®ç°Vueä¸­çš„watchåŠŸèƒ½ã€‚</a></p>\n<p>è¿™ç¯‡æ–‡ç« æˆ‘å†³å®šæ›´è¿›ä¸€æ­¥ï¼Œç›´æ¥ç”¨TypeScriptå®ç°ä¸€ä¸ªç±»å‹å®‰å…¨çš„ç®€æ˜“ç‰ˆçš„Vuexã€‚  </p>\n<h2 id=\"è¿™ç¯‡æ–‡ç« é€‚åˆè°ï¼š\"><a href=\"#%E8%BF%99%E7%AF%87%E6%96%87%E7%AB%A0%E9%80%82%E5%90%88%E8%B0%81%EF%BC%9A\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è¿™ç¯‡æ–‡ç« é€‚åˆè°ï¼š</h2>\n<ol>\n<li>å·²ç»å­¦ä¹ TypeScriptåŸºç¡€ï¼Œéœ€è¦ä¸€ç‚¹è¿›é˜¶ç©æ³•çš„ä½ ã€‚</li>\n<li>è‡ªå·±å–œæ¬¢å†™ä¸€äº›å¼€æºçš„å°å·¥å…·ï¼Œéœ€è¦è¿›é˜¶å­¦ä¹ TypeScriptç±»å‹æ¨å¯¼ã€‚ï¼ˆåœ¨é¡¹ç›®ä¸­ä¸€èˆ¬tsè¿ç”¨çš„æ¯”è¾ƒæµ…å±‚ï¼Œå¤§éƒ¨åˆ†æƒ…å†µåœ¨å†™è¡¨é¢çš„interfaceï¼‰ã€‚</li>\n<li>å•çº¯çš„æƒ³è¦è¿›é˜¶å­¦ä¹ TypeScriptã€‚</li>\n</ol>\n<h2 id=\"é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œä½ å¯ä»¥å­¦åˆ°ä»¥ä¸‹ç‰¹æ€§åœ¨å®æˆ˜ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼š\"><a href=\"#%E9%80%9A%E8%BF%87%E8%BF%99%E7%AF%87%E6%96%87%E7%AB%A0%EF%BC%8C%E4%BD%A0%E5%8F%AF%E4%BB%A5%E5%AD%A6%E5%88%B0%E4%BB%A5%E4%B8%8B%E7%89%B9%E6%80%A7%E5%9C%A8%E5%AE%9E%E6%88%98%E4%B8%AD%E6%98%AF%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8%E7%9A%84%EF%BC%9A\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œä½ å¯ä»¥å­¦åˆ°ä»¥ä¸‹ç‰¹æ€§åœ¨å®æˆ˜ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼š</h2>\n<ol>\n<li>ğŸ‰TypeScriptçš„é«˜çº§ç±»å‹ï¼ˆ<a href=\"https://www.typescriptlang.org/docs/handbook/advanced-types.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Advanced Type</a>ï¼‰</li>\n<li>ğŸ‰TypeScriptä¸­åˆ©ç”¨æ³›å‹è¿›è¡Œåå‘ç±»å‹æ¨å¯¼ã€‚(<a href=\"https://www.typescriptlang.org/docs/handbook/generics.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Generics</a>)</li>\n<li>ğŸ‰Mapped typesï¼ˆæ˜ å°„ç±»å‹ï¼‰</li>\n<li>ğŸ‰Distributive Conditional Typesï¼ˆæ¡ä»¶ç±»å‹åˆ†é…ï¼‰</li>\n<li>ğŸ‰TypeScriptä¸­Inferçš„å®æˆ˜åº”ç”¨ï¼ˆ<a href=\"https://github.com/vuejs/vue-next/blob/985f4c91d9d3f47e1314d230c249b3faf79c6b90/packages/reactivity/src/ref.ts#L89\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Vue3æºç é‡Œinferçš„ä¸€ä¸ªå¾ˆé‡è¦çš„ä½¿ç”¨</a>ï¼‰  </li>\n</ol>\n<p>å¸Œæœ›é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œä½ å¯ä»¥å¯¹TypeScriptçš„é«˜çº§ç±»å‹å®æˆ˜åº”ç”¨å¾—å¿ƒåº”æ‰‹ï¼Œå¯¹äºæœªæ¥æƒ³å­¦ä¹ Vue3æºç çš„å°ä¼™ä¼´æ¥è¯´ï¼Œç±»å‹æ¨æ–­å’Œ<code class=\"language-text\">infer</code>çš„ç”¨æ³•ä¹Ÿæ˜¯å¿…é¡»ç†Ÿæ‚‰çš„ã€‚ </p>\n<h2 id=\"å†™åœ¨å‰é¢ï¼š\"><a href=\"#%E5%86%99%E5%9C%A8%E5%89%8D%E9%9D%A2%EF%BC%9A\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å†™åœ¨å‰é¢ï¼š</h2>\n<p>æœ¬æ–‡å®ç°çš„Vuexåªæœ‰å¾ˆç®€å•çš„<code class=\"language-text\">state</code>ï¼Œ<code class=\"language-text\">action</code>å’Œ<code class=\"language-text\">subscribeAction</code>åŠŸèƒ½ï¼Œå› ä¸ºVuexå½“å‰çš„ç»„ç»‡æ¨¡å¼éå¸¸ä¸é€‚åˆç±»å‹æ¨å¯¼ï¼ˆVuexå®˜æ–¹çš„typeåº“ç›®å‰æ¨æ–­çš„ä¹Ÿå¾ˆç®€é™‹ï¼‰ï¼Œæ‰€ä»¥æœ¬æ–‡ä¸­ä¼šæœ‰ä¸€äº›å’Œå®˜æ–¹ä¸ä¸€è‡´çš„åœ°æ–¹ï¼Œè¿™äº›æ˜¯åˆ»æ„çš„ä¸ºäº†ç±»å‹å®‰å…¨è€Œåšçš„ï¼Œæœ¬æ–‡çš„ä¸»è¦ç›®æ ‡æ˜¯å­¦ä¹ TypeScriptï¼Œè€Œä¸æ˜¯å­¦ä¹ Vuexï¼Œæ‰€ä»¥è¯·å°ä¼™ä¼´ä»¬ä¸è¦å«Œå¼ƒå®ƒä»£ç å•°å—¦æˆ–è€…å’ŒVuexä¸ä¸€è‡´ã€‚ ğŸš€</p>\n<h2 id=\"vuexéª¨æ¶\"><a href=\"#vuex%E9%AA%A8%E6%9E%B6\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>vuexéª¨æ¶</h2>\n<p>é¦–å…ˆå®šä¹‰æˆ‘ä»¬Vuexçš„éª¨æ¶ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Vuex</span><span class=\"token operator\">&lt;</span><span class=\"token constant\">S</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">A</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n  state<span class=\"token punctuation\">:</span> <span class=\"token constant\">S</span>\n\n  action<span class=\"token punctuation\">:</span> Actions<span class=\"token operator\">&lt;</span><span class=\"token constant\">S</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">A</span><span class=\"token operator\">></span>\n\n  <span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> state<span class=\"token punctuation\">,</span> action <span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> state<span class=\"token punctuation\">:</span> <span class=\"token constant\">S</span><span class=\"token punctuation\">;</span> action<span class=\"token punctuation\">:</span> Actions<span class=\"token operator\">&lt;</span><span class=\"token constant\">S</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">A</span><span class=\"token operator\">></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> state<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>action <span class=\"token operator\">=</span> action<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>é¦–å…ˆè¿™ä¸ªVuexæ„é€ å‡½æ•°å®šäº†ä¸¤ä¸ªæ³›å‹<code class=\"language-text\">S</code>å’Œ<code class=\"language-text\">A</code>ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦æ¨å‡º<code class=\"language-text\">state</code>å’Œ<code class=\"language-text\">action</code>çš„ç±»å‹ï¼Œç”±äºsubscribeActionçš„å‚æ•°ä¸­éœ€è¦ç”¨åˆ°stateå’Œactionçš„ç±»å‹ï¼Œdispatchä¸­åˆ™éœ€è¦ç”¨åˆ°<code class=\"language-text\">action</code>çš„keyçš„ç±»å‹ï¼ˆæ¯”å¦‚<code class=\"language-text\">dispatch({type: &quot;ADD&quot;})</code>ä¸­çš„typeéœ€è¦ç”±å¯¹åº” <code class=\"language-text\">actions: { ADD() {} }</code>ï¼‰çš„keyå€¼æ¨æ–­ã€‚  </p>\n<p>ç„¶ååœ¨æ„é€ å‡½æ•°ä¸­ï¼ŒæŠŠSå’Œstateå¯¹åº”ï¼ŒæŠŠActions&#x3C;S, A>å’Œä¼ å…¥çš„actionå¯¹åº”ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> state<span class=\"token punctuation\">,</span> action <span class=\"token punctuation\">}</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> state<span class=\"token punctuation\">:</span> <span class=\"token constant\">S</span><span class=\"token punctuation\">;</span> action<span class=\"token punctuation\">:</span> Actions<span class=\"token operator\">&lt;</span><span class=\"token constant\">S</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">A</span><span class=\"token operator\">></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> state<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>action <span class=\"token operator\">=</span> action<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Actionsè¿™é‡Œç”¨åˆ°äº†æ˜ å°„ç±»å‹ï¼Œå®ƒç­‰äºæ˜¯éå†äº†ä¼ å…¥çš„Açš„keyå€¼ï¼Œç„¶åå®šä¹‰æ¯ä¸€é¡¹å®é™…ä¸Šçš„ç»“æ„ï¼Œ</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> Actions<span class=\"token operator\">&lt;</span><span class=\"token constant\">S</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">A</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">[</span><span class=\"token constant\">K</span> <span class=\"token keyword\">in</span> keyof <span class=\"token constant\">A</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">:</span> <span class=\"token constant\">S</span><span class=\"token punctuation\">,</span> payload<span class=\"token punctuation\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> Promise<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>çœ‹çœ‹æˆ‘ä»¬ä¼ å…¥çš„actions</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vuex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  state<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    count<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    message<span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  action<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">async</span> <span class=\"token constant\">ADD</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> payload<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+=</span> payload<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">async</span> <span class=\"token constant\">CHAT</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      state<span class=\"token punctuation\">.</span>message <span class=\"token operator\">=</span> message<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æ˜¯ä¸æ˜¯ç±»å‹æ­£å¥½å¯¹åº”ä¸Šäº†ï¼Ÿæ­¤æ—¶ADDå‡½æ•°çš„å½¢å‚é‡Œçš„stateå°±æœ‰äº†ç±»å‹æ¨æ–­ï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„stateçš„ç±»å‹ã€‚</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2020/1/9/16f880d77a929b47?w=463&#x26;h=250&#x26;f=png&#x26;s=106982\" alt=\"state\">  </p>\n<p>è¿™æ˜¯å› ä¸ºæˆ‘ä»¬ç»™Vuexçš„æ„é€ å‡½æ•°ä¼ å…¥stateçš„æ—¶å€™ï¼ŒSå°±è¢«åå‘æ¨å¯¼ä¸ºäº†stateçš„ç±»å‹ï¼Œä¹Ÿå°±æ˜¯<code class=\"language-text\">{count: number, message: string}</code>ï¼Œè¿™æ—¶Såˆè¢«ä¼ ç»™äº†<code class=\"language-text\">Actions&lt;S, A&gt;</code>ï¼Œ è‡ªç„¶ä¹Ÿå¯ä»¥åœ¨actioné‡Œè·å¾—stateçš„ç±»å‹äº†ã€‚ </p>\n<p>ç°åœ¨æœ‰ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç°åœ¨çš„å†™æ³•é‡Œæ²¡æœ‰ä»»ä½•åœ°æ–¹èƒ½ä½“ç°å‡º<code class=\"language-text\">payload</code>çš„ç±»å‹ï¼Œï¼ˆè¿™ä¹Ÿæ˜¯Vuexè®¾è®¡æ‰€å¸¦æ¥çš„ä¸€äº›ç¼ºé™·ï¼‰æ‰€ä»¥æˆ‘ä»¬ä¹Ÿåªèƒ½å†™æˆanyï¼Œä½†æ˜¯æˆ‘ä»¬æœ¬æ–‡çš„ç›®æ ‡æ˜¯ç±»å‹å®‰å…¨ã€‚  </p>\n<h2 id=\"dispatchçš„ç±»å‹å®‰å…¨\"><a href=\"#dispatch%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>dispatchçš„ç±»å‹å®‰å…¨</h2>\n<p>ä¸‹é¢å…ˆæƒ³ç‚¹åŠæ³•å®ç°<code class=\"language-text\">store.dispatch</code>çš„ç±»å‹å®‰å…¨ï¼š</p>\n<ol>\n<li>typeéœ€è¦è‡ªåŠ¨æç¤ºã€‚</li>\n<li>typeå¡«å†™äº†ä»¥åï¼Œéœ€è¦æç¤ºå¯¹åº”çš„payloadçš„typeã€‚</li>\n</ol>\n<p>æ‰€ä»¥å‚è€ƒ<code class=\"language-text\">redux</code>çš„ç©æ³•ï¼Œæˆ‘ä»¬æ‰‹åŠ¨å®šä¹‰ä¸€ä¸ªAction Typesçš„è”åˆç±»å‹ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> <span class=\"token constant\">ADD</span> <span class=\"token operator\">=</span> <span class=\"token string\">'ADD'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">CHAT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'CHAT'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> AddType <span class=\"token operator\">=</span> <span class=\"token keyword\">typeof</span> <span class=\"token constant\">ADD</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> ChatType <span class=\"token operator\">=</span> <span class=\"token keyword\">typeof</span> <span class=\"token constant\">CHAT</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> ActionTypes <span class=\"token operator\">=</span>\n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> AddType<span class=\"token punctuation\">;</span>\n      payload<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> ChatType<span class=\"token punctuation\">;</span>\n      payload<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>åœ¨<code class=\"language-text\">Vuex</code>ä¸­ï¼Œæˆ‘ä»¬æ–°å¢ä¸€ä¸ªè¾…åŠ©Tsæ¨æ–­çš„æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åŸå°ä¸åŠ¨çš„è¿”å›dispatchå‡½æ•°ï¼Œä½†æ˜¯ç”¨äº†<code class=\"language-text\">as</code>å…³é”®å­—æ”¹å†™å®ƒçš„ç±»å‹ï¼Œæˆ‘ä»¬éœ€è¦æŠŠActionTypesä½œä¸ºæ³›å‹ä¼ å…¥ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">export default class Vuex&lt;S, A&gt; {\n  ... \n  \n  createDispatch&lt;A&gt;() {\n    return this.dispatch.bind(this) as Dispatch&lt;A&gt;;\n  }\n}</code></pre></div>\n<p>Dispatchç±»å‹çš„å®ç°ç›¸å½“ç®€å•ï¼Œç›´æ¥æŠŠæ³›å‹Aäº¤ç»™ç¬¬ä¸€ä¸ªå½¢å‚actionå°±å¥½äº†ï¼Œç”±äºActionTypesæ˜¯è”åˆç±»å‹ï¼ŒTsä¼šä¸¥æ ¼é™åˆ¶æˆ‘ä»¬å¡«å†™çš„actionçš„ç±»å‹å¿…é¡»æ˜¯AddTypeæˆ–è€…ChatTypeä¸­çš„ä¸€ç§ï¼Œå¹¶ä¸”å¡«å†™äº†AddTypeåï¼Œpayloadçš„ç±»å‹ä¹Ÿå¿…é¡»æ˜¯numberäº†ã€‚  </p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">Dispatch</span><span class=\"token operator\">&lt;</span><span class=\"token constant\">A</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">:</span> <span class=\"token constant\">A</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ç„¶åä½¿ç”¨å®ƒæ„é€ dispatch</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token comment\">// for TypeScript support</span>\n<span class=\"token keyword\">const</span> dispatch <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span>createDispatch<span class=\"token operator\">&lt;</span>ActionTypes<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p> ç›®æ ‡è¾¾æˆï¼š</p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2020/1/9/16f881771ec7ca80?w=715&#x26;h=85&#x26;f=png&#x26;s=23458\" alt=\"type\"></p>\n<p><img src=\"https://user-gold-cdn.xitu.io/2020/1/9/16f8817d3a2346ab?w=713&#x26;h=107&#x26;f=png&#x26;s=33185\" alt=\"payload\">  </p>\n<h2 id=\"actionå½¢å‚ä¸­payloadçš„ç±»å‹å®‰å…¨\"><a href=\"#action%E5%BD%A2%E5%8F%82%E4%B8%ADpayload%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%AE%89%E5%85%A8\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>actionå½¢å‚ä¸­payloadçš„ç±»å‹å®‰å…¨</h2>\n<p>æ­¤æ—¶è™½ç„¶store.diaptchå®Œå…¨åšåˆ°äº†ç±»å‹å®‰å…¨ï¼Œä½†æ˜¯åœ¨å£°æ˜actionä¼ å…¥vuexæ„é€ å‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä¸æƒ³åƒè¿™æ ·æ‰‹åŠ¨å£°æ˜ï¼Œ  </p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vuex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  state<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    count<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    message<span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  action<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">async</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">ADD</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> payload<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+=</span> payload<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">async</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">CHAT</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      state<span class=\"token punctuation\">.</span>message <span class=\"token operator\">=</span> message<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  </code></pre></div>\n<p>å› ä¸ºè¿™ä¸ªç±»å‹åœ¨åˆšåˆšå®šä¹‰çš„ActionTypesä¸­å·²ç»æœ‰äº†ï¼Œç§‰ç€<code class=\"language-text\">DRY</code>çš„åŸåˆ™ï¼Œæˆ‘ä»¬ç»§ç»­æŠ˜è…¾å§ã€‚  </p>\n<p>é¦–å…ˆç°åœ¨æˆ‘ä»¬æœ‰è¿™äº›ä½æ–™ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> <span class=\"token constant\">ADD</span> <span class=\"token operator\">=</span> <span class=\"token string\">'ADD'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">CHAT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'CHAT'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> AddType <span class=\"token operator\">=</span> <span class=\"token keyword\">typeof</span> <span class=\"token constant\">ADD</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> ChatType <span class=\"token operator\">=</span> <span class=\"token keyword\">typeof</span> <span class=\"token constant\">CHAT</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> ActionTypes <span class=\"token operator\">=</span>\n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> AddType<span class=\"token punctuation\">;</span>\n      payload<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> ChatType<span class=\"token punctuation\">;</span>\n      payload<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æ‰€ä»¥æˆ‘æƒ³é€šè¿‡ä¸€ä¸ªç±»å‹å·¥å…·ï¼Œèƒ½å¤Ÿä¼ å…¥AddTypeç»™æˆ‘è¿”å›numberï¼Œä¼ å…¥ChatTypeç»™æˆ‘è¿”å›messageï¼š  </p>\n<p>å®ƒå¤§æ¦‚æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">type AddPayload = PickPayload&lt;ActionTypes, AddType&gt; // number\ntype ChatPayload = PickPayload&lt;ActionTypes, ChatType&gt; // string</code></pre></div>\n<p>ä¸ºäº†å®ç°å®ƒï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°<a href=\"https://mariusschulz.com/blog/conditional-types-in-typescript#distributive-conditional-types\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">distributive-conditional-types</a>ï¼Œä¸ç†Ÿæ‚‰çš„åŒå­¦å¯ä»¥å¥½å¥½çœ‹çœ‹è¿™ç¯‡æ–‡ç« ã€‚</p>\n<p>ç®€å•çš„æ¥è¯´ï¼Œå¦‚æœæˆ‘ä»¬æŠŠä¸€ä¸ªè”åˆç±»å‹</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">type</span> <span class=\"token constant\">A</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">string</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">number</span></code></pre></div>\n<p>ä¼ é€’ç»™ä¸€ä¸ªç”¨äº†extendså…³é”®å­—çš„ç±»å‹å·¥å…·ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">type</span> PickString<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token constant\">T</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">string</span> <span class=\"token operator\">?</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">:</span> never\n\n<span class=\"token keyword\">type</span> <span class=\"token constant\">T1</span> <span class=\"token operator\">=</span> PickString<span class=\"token operator\">&lt;</span><span class=\"token constant\">A</span><span class=\"token operator\">></span> <span class=\"token comment\">// string</span></code></pre></div>\n<p>å®ƒå¹¶ä¸æ˜¯åƒæˆ‘ä»¬æƒ³è±¡ä¸­çš„ç›´æ¥å»ç”¨string | numberç›´æ¥åŒ¹é…æ˜¯å¦extendsï¼Œè€Œæ˜¯æŠŠè”åˆç±»å‹æ‹†åˆ†å¼€æ¥ï¼Œä¸€ä¸ªä¸ªå»åŒ¹é…ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">type PickString&lt;T&gt; = \n| string extends string ? T: never \n| number extends string ? T: never</code></pre></div>\n<p>æ‰€ä»¥è¿”å›çš„ç±»å‹æ˜¯<code class=\"language-text\">string | never</code>ï¼Œç”±ç”±äºneveråœ¨è”åˆç±»å‹ä¸­æ²¡ä»€ä¹ˆæ„ä¹‰ï¼Œæ‰€ä»¥å°±è¢«è¿‡æ»¤æˆ<code class=\"language-text\">string</code>äº†</p>\n<p>å€Ÿç”±è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å°±æœ‰æ€è·¯äº†ï¼Œè¿™é‡Œç”¨åˆ°äº†<code class=\"language-text\">infer</code>è¿™ä¸ªå…³é”®å­—ï¼ŒVue3ä¸­ä¹Ÿæœ‰å¾ˆå¤šæ¨æ–­æ˜¯å€ŸåŠ©å®ƒå®ç°çš„ï¼Œå®ƒåªèƒ½ç”¨åœ¨extendsçš„åé¢ï¼Œä»£è¡¨ä¸€ä¸ªè¿˜æœªå‡ºç°çš„ç±»å‹ï¼Œå…³äºinferçš„ç©æ³•ï¼Œè¯¦ç»†å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://segmentfault.com/a/1190000018514540?utm_source=tag-newest\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å·§ç”¨ TypeScriptï¼ˆäº”ï¼‰---- infer</a></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">export type PickPayload&lt;Types, Type&gt; = Types extends {\n  type: Type;\n  payload: infer P;\n}\n  ? P\n  : never;</code></pre></div>\n<p>æˆ‘ä»¬ç”¨Typeè¿™ä¸ªå­—ç¬¦ä¸²ç±»å‹ï¼Œè®©ActionTypesä¸­çš„æ¯ä¸€ä¸ªç±»å‹ä¸€ä¸ªä¸ªå»è¿‡æ»¤åŒ¹é…ï¼Œæ¯”å¦‚ä¼ å…¥çš„æ˜¯AddType:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">PickPayload&lt;ActionTypes, AddType&gt;</code></pre></div>\n<p>åˆ™ä¼šè¢«åˆ†å¸ƒæˆï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">type</span> <span class=\"token constant\">A</span> <span class=\"token operator\">=</span> \n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> AddType<span class=\"token punctuation\">;</span>payload<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span><span class=\"token punctuation\">}</span> <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> AddType<span class=\"token punctuation\">;</span> payload<span class=\"token punctuation\">:</span> infer <span class=\"token constant\">P</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">?</span> <span class=\"token constant\">P</span>\n  <span class=\"token punctuation\">:</span> never \n  <span class=\"token operator\">|</span> \n  <span class=\"token punctuation\">{</span> <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> ChatType<span class=\"token punctuation\">;</span> payload<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">extends</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> AddType<span class=\"token punctuation\">;</span> payload<span class=\"token punctuation\">:</span> infer <span class=\"token constant\">P</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">?</span> <span class=\"token constant\">P</span>\n  <span class=\"token punctuation\">:</span> never<span class=\"token punctuation\">;</span></code></pre></div>\n<p>æ³¨æ„infer Pçš„ä½ç½®ï¼Œè¢«æ”¾åœ¨äº†payloadçš„ä½ç½®ä¸Šï¼Œæ‰€ä»¥ç¬¬ä¸€é¡¹çš„typeåœ¨å‘½ä¸­å, Pä¹Ÿè¢«è‡ªåŠ¨æ¨æ–­ä¸ºäº†numberï¼Œè€Œä¸‰å…ƒè¿ç®—ç¬¦çš„ ? åï¼Œæˆ‘ä»¬æ­£æ˜¯è¿”å›äº†Pï¼Œä¹Ÿå°±æ¨æ–­å‡ºäº†numberè¿™ä¸ªç±»å‹ã€‚  </p>\n<p>è¿™æ—¶å€™å°±å¯ä»¥å®Œæˆæˆ‘ä»¬ä¹‹å‰çš„ç›®æ ‡äº†ï¼Œä¹Ÿå°±æ˜¯æ ¹æ®AddTypeè¿™ä¸ªç±»å‹æ¨æ–­å‡ºpayloadå‚æ•°çš„ç±»å‹ï¼Œ<code class=\"language-text\">PickPayload</code>è¿™ä¸ªå·¥å…·ç±»å‹åº”è¯¥å®šä½æˆvuexå®˜æ–¹ä»“åº“é‡Œæä¾›çš„è¾…åŠ©å·¥å…·ï¼Œè€Œåœ¨é¡¹ç›®ä¸­ï¼Œç”±äºActionTypeå·²ç»ç¡®å®šï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥çš„æå‰å›ºå®šå‚æ•°ã€‚ï¼ˆæœ‰ç‚¹ç±»ä¼¼äºå‡½æ•°æŸ¯é‡ŒåŒ–ï¼‰</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">type</span> PickStorePayload<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> PickPayload<span class=\"token operator\">&lt;</span>ActionTypes<span class=\"token punctuation\">,</span> <span class=\"token constant\">T</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç±»å‹å®‰å…¨çš„Vuexå®ä¾‹æ‰€éœ€è¦çš„æ‰€æœ‰è¾…åŠ©ç±»å‹éƒ½å®šä¹‰å®Œæ¯•ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> <span class=\"token constant\">ADD</span> <span class=\"token operator\">=</span> <span class=\"token string\">'ADD'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token constant\">CHAT</span> <span class=\"token operator\">=</span> <span class=\"token string\">'CHAT'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> AddType <span class=\"token operator\">=</span> <span class=\"token keyword\">typeof</span> <span class=\"token constant\">ADD</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">type</span> ChatType <span class=\"token operator\">=</span> <span class=\"token keyword\">typeof</span> <span class=\"token constant\">CHAT</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> ActionTypes <span class=\"token operator\">=</span>\n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> AddType<span class=\"token punctuation\">;</span>\n      payload<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">|</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> ChatType<span class=\"token punctuation\">;</span>\n      payload<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> PickStorePayload<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> PickPayload<span class=\"token operator\">&lt;</span>ActionTypes<span class=\"token punctuation\">,</span> <span class=\"token constant\">T</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä½¿ç”¨èµ·æ¥å°±å¾ˆç®€å•äº†ï¼š  </p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Vuex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  state<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    count<span class=\"token punctuation\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n    message<span class=\"token punctuation\">:</span> <span class=\"token string\">''</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  action<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">async</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">ADD</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> payload<span class=\"token punctuation\">:</span> PickStorePayload<span class=\"token operator\">&lt;</span>AddType<span class=\"token operator\">></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      state<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+=</span> payload<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">async</span> <span class=\"token punctuation\">[</span><span class=\"token constant\">CHAT</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">:</span> PickStorePayload<span class=\"token operator\">&lt;</span>ChatType<span class=\"token operator\">></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      state<span class=\"token punctuation\">.</span>message <span class=\"token operator\">=</span> message<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// for TypeScript support</span>\n<span class=\"token keyword\">const</span> dispatch <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span>createDispatch<span class=\"token operator\">&lt;</span>ActionTypes<span class=\"token operator\">></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">ADD</span><span class=\"token punctuation\">,</span>\n  payload<span class=\"token punctuation\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">type</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">CHAT</span><span class=\"token punctuation\">,</span>\n  payload<span class=\"token punctuation\">:</span> <span class=\"token string\">'Hello World'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"æ€»ç»“\"><a href=\"#%E6%80%BB%E7%BB%93\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æ€»ç»“</h2>\n<p>æœ¬æ–‡çš„æ‰€æœ‰ä»£ç éƒ½åœ¨<br>\n<a href=\"https://github.com/sl1673495/tiny-middlewares/blob/master/vuex.ts\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://github.com/sl1673495/tiny-middlewares/blob/master/vuex.ts</a><br>\nä»“åº“é‡Œï¼Œé‡Œé¢è¿˜åŠ ä¸Šäº†gettersçš„å®ç°å’Œç±»å‹æ¨å¯¼ã€‚</p>\n<p>é€šè¿‡æœ¬æ–‡çš„å­¦ä¹ ï¼Œç›¸ä¿¡ä½ ä¼šå¯¹é«˜çº§ç±»å‹çš„ç”¨æ³•æœ‰è¿›ä¸€æ­¥çš„ç†è§£ï¼Œä¹Ÿä¼šå¯¹TypeScriptçš„å¼ºå¤§æ›´åŠ å¹æœï¼Œæœ¬æ–‡æœ‰å¾ˆå¤šä¾‹å­éƒ½æ˜¯ä¸ºäº†æ•™å­¦è€Œåˆ»æ„æ·±ç©¶ï¼Œå¤æ‚åŒ–çš„ï¼Œè¯·ä¸è¦éª‚æˆ‘ï¼ˆXDï¼‰ã€‚  </p>\n<p>åœ¨å®é™…çš„é¡¹ç›®è¿ç”¨ä¸­ï¼Œé¦–å…ˆæˆ‘ä»¬åº”è¯¥é¿å…Vuexè¿™ç§é›†ä¸­åŒ–çš„ç±»å‹å®šä¹‰ï¼Œè€Œå°½é‡å»æ‹¥æŠ±å‡½æ•°ï¼ˆå‡½æ•°å¯¹äºTypeScriptæ˜¯å¤©ç„¶æ”¯æŒï¼‰ï¼Œè¿™ä¹Ÿæ˜¯Vue3å¾€å‡½æ•°åŒ–apiæ–¹å‘èµ°çš„åŸå› ä¹‹ä¸€ã€‚  </p>\n<h2 id=\"å‚è€ƒæ–‡ç« \"><a href=\"#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‚è€ƒæ–‡ç« </h2>\n<p>React + Typescript å·¥ç¨‹åŒ–æ²»ç†å®è·µï¼ˆèš‚èšé‡‘æœçš„å¤§ä½¬å®è·µæ€»ç»“æ€»æ˜¯è¿™ä¹ˆé è°±ï¼‰\n<a href=\"https://juejin.im/post/5dccc9b8e51d4510840165e2#comment\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://juejin.im/post/5dccc9b8e51d4510840165e2#comment</a>  </p>\n<p>TS å­¦ä¹ æ€»ç»“ï¼šç¼–è¯‘é€‰é¡¹ &#x26;&#x26; ç±»å‹ç›¸å…³æŠ€å·§\n<a href=\"http://zxc0328.github.io/diary/2019/10/2019-10-05.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://zxc0328.github.io/diary/2019/10/2019-10-05.html</a>  </p>\n<p>Conditional types in TypeScriptï¼ˆæ®è¯´æ¯”Tså®˜ç½‘è®²çš„å¥½ï¼‰\n<a href=\"https://mariusschulz.com/blog/conditional-types-in-typescript#distributive-conditional-types\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://mariusschulz.com/blog/conditional-types-in-typescript#distributive-conditional-types</a>  </p>\n<p>Conditional Types in TypeScriptï¼ˆæ–‡é£å¹½é»˜ï¼Œä»£ç éå¸¸ç¡¬æ ¸ï¼‰\n<a href=\"https://artsy.github.io/blog/2018/11/21/conditional-types-in-typescript/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">https://artsy.github.io/blog/2018/11/21/conditional-types-in-typescript/</a></p>","timeToRead":9,"frontmatter":{"title":"TypeScriptè¿›é˜¶å®ç°æ™ºèƒ½ç±»å‹æ¨å¯¼çš„ç®€åŒ–ç‰ˆVuex","date":"January 14, 2020","spoiler":""},"fields":{"slug":"/549412377/","langKey":"en"}}},"pageContext":{"slug":"/549412377/","previous":{"fields":{"slug":"/549412665/","langKey":"en","directoryName":"549412665"},"frontmatter":{"title":"React-Redux 100è¡Œä»£ç ç®€æ˜“ç‰ˆæ¢ç©¶åŸç†"}},"next":{"fields":{"slug":"/551280991/","langKey":"en","directoryName":"551280991"},"frontmatter":{"title":"TypeScriptä»é›¶å®ç°åŸºäºProxyçš„å“åº”å¼åº“ æ™®é€šæ•°æ®ç±»å‹"}},"translations":[],"translatedLinks":[]}},"staticQueryHashes":["336482444"]}