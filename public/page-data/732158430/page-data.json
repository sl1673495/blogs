{"componentChunkName":"component---src-templates-blog-post-js","path":"/732158430/","result":{"data":{"site":{"siteMetadata":{"title":"sshçš„åšå®¢","author":"ssh"}},"markdownRemark":{"id":"c1da3c5d-d887-5be0-a231-762c720f7827","html":"<h2 id=\"å‰è¨€\"><a href=\"#%E5%89%8D%E8%A8%80\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å‰è¨€</h2>\n<p>æˆ‘å·¥ä½œä¸­çš„æŠ€æœ¯æ ˆä¸»è¦æ˜¯ React + TypeScriptï¼Œè¿™ç¯‡æ–‡ç« æˆ‘æƒ³æ€»ç»“ä¸€ä¸‹å¦‚ä½•åœ¨é¡¹ç›®ä¸­è¿ç”¨ React çš„ä¸€äº›æŠ€å·§å»è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ï¼Œæˆ–è€…æ›´å¥½çš„ä»£ç ç»„ç»‡ã€‚</p>\n<p>æ€§èƒ½ä¼˜åŒ–çš„é‡è¦æ€§ä¸ç”¨å¤šè¯´ï¼Œè°·æ­Œå‘å¸ƒçš„å¾ˆå¤šè°ƒç ”ç²¾ç¡®çš„å±•ç¤ºäº†æ€§èƒ½å¯¹äºç½‘ç«™ç•™å­˜ç‡çš„å½±å“ï¼Œè€Œä»£ç ç»„ç»‡ä¼˜åŒ–åˆ™å…³ç³»åˆ°åç»­çš„ç»´æŠ¤æˆæœ¬ï¼Œä»¥åŠä½ åŒäº‹ç»´æŠ¤ä½ ä»£ç æ—¶å€™â€œå£åèŠ¬èŠ³â€çš„é¢‘ç‡ ğŸ˜ï¼Œæœ¬ç¯‡æ–‡ç« çœ‹å®Œï¼Œä½ ä¸€å®šä¼šæœ‰æ‰€æ”¶è·ã€‚</p>\n<blockquote>\n<p>æœ¬æ–‡é¦–å‘äºã€Œ<strong>å‰ç«¯ä»è¿›é˜¶åˆ°å…¥é™¢</strong>ã€ã€‚å…³æ³¨æˆ‘ï¼Œå¸¦ä½ è¿›é˜¶~</p>\n</blockquote>\n<h2 id=\"ç¥å¥‡çš„-children\"><a href=\"#%E7%A5%9E%E5%A5%87%E7%9A%84-children\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¥å¥‡çš„ children</h2>\n<p>æˆ‘ä»¬æœ‰ä¸€ä¸ªéœ€æ±‚ï¼Œéœ€è¦é€šè¿‡ Provider ä¼ é€’ä¸€äº›ä¸»é¢˜ä¿¡æ¯ç»™å­ç»„ä»¶ï¼š</p>\n<p>çœ‹è¿™æ ·ä¸€æ®µä»£ç ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useContext<span class=\"token punctuation\">,</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> ThemeContext <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">ChildNonTheme</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ä¸å…³å¿ƒçš®è‚¤çš„å­ç»„ä»¶æ¸²æŸ“äº†'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>æˆ‘ä¸å…³å¿ƒçš®è‚¤ï¼Œçš®è‚¤æ”¹å˜çš„æ—¶å€™åˆ«è®©æˆ‘é‡æ–°æ¸²æŸ“ï¼<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">ChildWithTheme</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> theme <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>ThemeContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>æˆ‘æ˜¯æœ‰çš®è‚¤çš„å“¦<span class=\"token operator\">~</span> <span class=\"token punctuation\">{</span>theme<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>theme<span class=\"token punctuation\">,</span> setTheme<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'light'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onChangeTheme</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setTheme</span><span class=\"token punctuation\">(</span>theme <span class=\"token operator\">===</span> <span class=\"token string\">'light'</span> <span class=\"token operator\">?</span> <span class=\"token string\">'dark'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'light'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>ThemeContext<span class=\"token punctuation\">.</span>Provider value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>theme<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>onChangeTheme<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>æ”¹å˜çš®è‚¤<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildWithTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildNonTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildNonTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildNonTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildNonTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildNonTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildNonTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildNonTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>ThemeContext<span class=\"token punctuation\">.</span>Provider<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¿™æ®µä»£ç çœ‹èµ·æ¥æ²¡å•¥é—®é¢˜ï¼Œä¹Ÿå¾ˆç¬¦åˆæ’¸èµ·è¢–å­å°±å¹²çš„ç›´è§‰ï¼Œä½†æ˜¯å´ä¼šè®© <code class=\"language-text\">ChildNonTheme</code> è¿™ä¸ªä¸å…³å¿ƒçš®è‚¤çš„å­ç»„ä»¶ï¼Œåœ¨çš®è‚¤çŠ¶æ€æ›´æ”¹çš„æ—¶å€™ä¹Ÿè¿›è¡Œæ— æ•ˆçš„é‡æ–°æ¸²æŸ“ã€‚</p>\n<p><img src=\"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/cbc0cbaaa6654f3fb990a7f0356085e1~tplv-k3u1fbpfcp-watermark.image\"></p>\n<p>è¿™æœ¬è´¨ä¸Šæ˜¯ç”±äº React æ˜¯è‡ªä¸Šè€Œä¸‹é€’å½’æ›´æ–°ï¼Œ<code class=\"language-text\">&lt;ChildNonTheme /&gt;</code> è¿™æ ·çš„ä»£ç ä¼šè¢« babel ç¿»è¯‘æˆ <code class=\"language-text\">React.createElement(ChildNonTheme)</code> è¿™æ ·çš„å‡½æ•°è°ƒç”¨ï¼ŒReact å®˜æ–¹ç»å¸¸å¼ºè°ƒ props æ˜¯ immutable çš„ï¼Œæ‰€ä»¥åœ¨æ¯æ¬¡è°ƒç”¨å‡½æ•°å¼ç»„ä»¶çš„æ—¶å€™ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä»½æ–°çš„ props å¼•ç”¨ã€‚</p>\n<p>æ¥çœ‹ä¸‹ <code class=\"language-text\">createElement</code> çš„è¿”å›ç»“æ„ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> childNonThemeElement <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  type<span class=\"token punctuation\">:</span> <span class=\"token string\">'ChildNonTheme'</span><span class=\"token punctuation\">,</span>\n  props<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// &lt;- è¿™ä¸ªå¼•ç”¨æ›´æ–°äº†</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æ­£æ˜¯ç”±äºè¿™ä¸ªæ–°çš„ props å¼•ç”¨ï¼Œå¯¼è‡´ <code class=\"language-text\">ChildNonTheme</code> è¿™ä¸ªç»„ä»¶ä¹Ÿé‡æ–°æ¸²æŸ“äº†ã€‚</p>\n<p>é‚£ä¹ˆå¦‚ä½•é¿å…è¿™ä¸ªæ— æ•ˆçš„é‡æ–°æ¸²æŸ“å‘¢ï¼Ÿå…³é”®è¯æ˜¯ã€Œå·§å¦™åˆ©ç”¨ childrenã€ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useContext<span class=\"token punctuation\">,</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> ThemeContext <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">ChildNonTheme</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ä¸å…³å¿ƒçš®è‚¤çš„å­ç»„ä»¶æ¸²æŸ“äº†'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>æˆ‘ä¸å…³å¿ƒçš®è‚¤ï¼Œçš®è‚¤æ”¹å˜çš„æ—¶å€™åˆ«è®©æˆ‘é‡æ–°æ¸²æŸ“ï¼<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">ChildWithTheme</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> theme <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>ThemeContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>æˆ‘æ˜¯æœ‰çš®è‚¤çš„å“¦<span class=\"token operator\">~</span> <span class=\"token punctuation\">{</span>theme<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">ThemeApp</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> children <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>theme<span class=\"token punctuation\">,</span> setTheme<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">'light'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">onChangeTheme</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setTheme</span><span class=\"token punctuation\">(</span>theme <span class=\"token operator\">===</span> <span class=\"token string\">'light'</span> <span class=\"token operator\">?</span> <span class=\"token string\">'dark'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'light'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>ThemeContext<span class=\"token punctuation\">.</span>Provider value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>theme<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>onChangeTheme<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>æ”¹å˜çš®è‚¤<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>ThemeContext<span class=\"token punctuation\">.</span>Provider<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>ThemeApp<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildWithTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildNonTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildNonTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildNonTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildNonTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildNonTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildNonTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>ChildNonTheme <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>ThemeApp<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æ²¡é”™ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯æˆ‘æŠŠæ§åˆ¶çŠ¶æ€çš„ç»„ä»¶å’Œè´Ÿè´£å±•ç¤ºçš„å­ç»„ä»¶ç»™æŠ½ç¦»å¼€äº†ï¼Œé€šè¿‡ children ä¼ å…¥åç›´æ¥æ¸²æŸ“ï¼Œç”±äº children ä»å¤–éƒ¨ä¼ å…¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ <code class=\"language-text\">ThemeApp</code> è¿™ä¸ªç»„ä»¶å†…éƒ¨ä¸ä¼šå†æœ‰ <code class=\"language-text\">React.createElement</code> è¿™æ ·çš„ä»£ç ï¼Œé‚£ä¹ˆåœ¨ <code class=\"language-text\">setTheme</code> è§¦å‘é‡æ–°æ¸²æŸ“åï¼Œ<code class=\"language-text\">children</code> å®Œå…¨æ²¡æœ‰æ”¹å˜ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥å¤ç”¨ã€‚</p>\n<p>è®©æˆ‘ä»¬å†çœ‹ä¸€ä¸‹è¢« <code class=\"language-text\">ThemeApp</code> åŒ…è£¹ä¸‹çš„ <code class=\"language-text\">&lt;ChildNonTheme /&gt;</code>ï¼Œå®ƒä¼šä½œä¸º <code class=\"language-text\">children</code> ä¼ é€’ç»™ <code class=\"language-text\">ThemeApp</code>ï¼Œ<code class=\"language-text\">ThemeApp</code> å†…éƒ¨çš„æ›´æ–°å®Œå…¨ä¸ä¼šè§¦å‘å¤–éƒ¨çš„ <code class=\"language-text\">React.createElement</code>ï¼Œæ‰€ä»¥ä¼šç›´æ¥å¤ç”¨ä¹‹å‰çš„ <code class=\"language-text\">element</code> ç»“æœï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// å®Œå…¨å¤ç”¨ï¼Œprops ä¹Ÿä¸ä¼šæ”¹å˜ã€‚</span>\n<span class=\"token keyword\">const</span> childNonThemeElement <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  type<span class=\"token punctuation\">:</span> ChildNonTheme<span class=\"token punctuation\">,</span>\n  props<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5c765f346ad74cd69f54a02cec5224f1~tplv-k3u1fbpfcp-watermark.image\"></p>\n<p>åœ¨æ”¹å˜çš®è‚¤ä¹‹åï¼Œæ§åˆ¶å°ç©ºç©ºå¦‚ä¹Ÿï¼ä¼˜åŒ–è¾¾æˆã€‚</p>\n<p>æ€»ç»“ä¸‹æ¥ï¼Œå°±æ˜¯è¦æŠŠæ¸²æŸ“æ¯”è¾ƒè´¹æ—¶ï¼Œä½†æ˜¯ä¸éœ€è¦å…³å¿ƒçŠ¶æ€çš„å­ç»„ä»¶æå‡åˆ°ã€Œæœ‰çŠ¶æ€ç»„ä»¶ã€çš„å¤–éƒ¨ï¼Œä½œä¸º children æˆ–è€… props ä¼ é€’è¿›å»ç›´æ¥ä½¿ç”¨ï¼Œé˜²æ­¢è¢«å¸¦ç€ä¸€èµ·æ¸²æŸ“ã€‚</p>\n<p><a href=\"https://codesandbox.io/s/react-shenqidechildren-lfmn0\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">ç¥å¥‡çš„ children - åœ¨çº¿è°ƒè¯•åœ°å€</a></p>\n<p>å½“ç„¶ï¼Œè¿™ä¸ªä¼˜åŒ–ä¹Ÿä¸€æ ·å¯ä»¥ç”¨ React.memo åŒ…è£¹å­ç»„ä»¶æ¥åšï¼Œä¸è¿‡ç›¸å¯¹çš„å¢åŠ ç»´æŠ¤æˆæœ¬ï¼Œæ ¹æ®åœºæ™¯æƒè¡¡é€‰æ‹©å§ã€‚</p>\n<h2 id=\"context-è¯»å†™åˆ†ç¦»\"><a href=\"#context-%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Context è¯»å†™åˆ†ç¦»</h2>\n<p>æƒ³è±¡ä¸€ä¸‹ï¼Œç°åœ¨æˆ‘ä»¬æœ‰ä¸€ä¸ªå…¨å±€æ—¥å¿—è®°å½•çš„éœ€æ±‚ï¼Œæˆ‘ä»¬æƒ³é€šè¿‡ Provider å»åšï¼Œå¾ˆå¿«ä»£ç å°±å†™å¥½äº†ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useContext<span class=\"token punctuation\">,</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"react\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">\"./styles.css\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> LogContext <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">LogProvider</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> children <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>logs<span class=\"token punctuation\">,</span> setLogs<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">addLog</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>log<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setLogs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>prevLogs<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>prevLogs<span class=\"token punctuation\">,</span> log<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>LogContext<span class=\"token punctuation\">.</span>Provider value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> logs<span class=\"token punctuation\">,</span> addLog <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>LogContext<span class=\"token punctuation\">.</span>Provider<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Logger1</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> addLog <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>LogContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Logger1 render'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>ä¸€ä¸ªèƒ½å‘æ—¥å¿—çš„ç»„ä»¶<span class=\"token number\">1</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">addLog</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"logger1\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>å‘æ—¥å¿—<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">Logger2</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> addLog <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>LogContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Logger2 render'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>p<span class=\"token operator\">></span>ä¸€ä¸ªèƒ½å‘æ—¥å¿—çš„ç»„ä»¶<span class=\"token number\">2</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">addLog</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"logger2\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>å‘æ—¥å¿—<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">LogsPanel</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> logs <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>LogContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> logs<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>log<span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>p key<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>index<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>log<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>p<span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>LogProvider<span class=\"token operator\">></span>\n      <span class=\"token punctuation\">{</span><span class=\"token comment\">/* å†™æ—¥å¿— */</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span>Logger1 <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Logger2 <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token punctuation\">{</span><span class=\"token comment\">/* è¯»æ—¥å¿— */</span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span>LogsPanel <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>LogProvider<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æˆ‘ä»¬å·²ç»ç”¨ä¸Šäº†ä¸Šä¸€ç« èŠ‚çš„ä¼˜åŒ–å°æŠ€å·§ï¼Œå•ç‹¬çš„æŠŠ <code class=\"language-text\">LogProvider</code> å°è£…èµ·æ¥ï¼Œå¹¶ä¸”æŠŠå­ç»„ä»¶æå‡åˆ°å¤–å±‚ä¼ å…¥ã€‚</p>\n<p>å…ˆæ€è€ƒä¸€ä¸‹æœ€ä½³çš„æƒ…å†µï¼Œ<code class=\"language-text\">Logger</code> ç»„ä»¶åªè´Ÿè´£å‘å‡ºæ—¥å¿—ï¼Œå®ƒæ˜¯ä¸å…³å¿ƒ<code class=\"language-text\">logs</code>çš„å˜åŒ–çš„ï¼Œåœ¨ä»»ä½•ç»„ä»¶è°ƒç”¨ <code class=\"language-text\">addLog</code> å»å†™å…¥æ—¥å¿—çš„æ—¶å€™ï¼Œç†æƒ³çš„æƒ…å†µä¸‹åº”è¯¥åªæœ‰ <code class=\"language-text\">LogsPanel</code> è¿™ä¸ªç»„ä»¶å‘ç”Ÿé‡æ–°æ¸²æŸ“ã€‚</p>\n<p>ä½†æ˜¯è¿™æ ·çš„ä»£ç å†™æ³•å´ä¼šå¯¼è‡´æ¯æ¬¡ä»»æ„ä¸€ä¸ªç»„ä»¶å†™å…¥æ—¥å¿—ä»¥åï¼Œæ‰€æœ‰çš„ <code class=\"language-text\">Logger</code> å’Œ <code class=\"language-text\">LogsPanel</code> éƒ½å‘ç”Ÿé‡æ–°æ¸²æŸ“ã€‚</p>\n<p><img src=\"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/124b9e8ff1c746bf9fae21c938870b31~tplv-k3u1fbpfcp-watermark.image\"></p>\n<p>è¿™è‚¯å®šä¸æ˜¯æˆ‘ä»¬é¢„æœŸçš„ï¼Œå‡è®¾åœ¨ç°å®åœºæ™¯çš„ä»£ç ä¸­ï¼Œèƒ½å†™æ—¥å¿—çš„ç»„ä»¶å¯å¤šç€å‘¢ï¼Œæ¯æ¬¡ä¸€å†™å…¥å°±å¯¼è‡´å…¨å±€çš„ç»„ä»¶éƒ½é‡æ–°æ¸²æŸ“ï¼Ÿè¿™å½“ç„¶æ˜¯ä¸èƒ½æ¥å—çš„ï¼Œå‘ç”Ÿè¿™ä¸ªé—®é¢˜çš„æœ¬è´¨åŸå› <a href=\"https://zh-hans.reactjs.org/docs/context.html#contextprovider\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å®˜ç½‘ Context çš„éƒ¨åˆ†</a>å·²ç»è®²å¾—å¾ˆæ¸…æ¥šäº†ï¼š</p>\n<p><img src=\"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/836852500f994ab680ef17e807fb0e69~tplv-k3u1fbpfcp-watermark.image\"></p>\n<p>å½“ <code class=\"language-text\">LogProvider</code> ä¸­çš„ <code class=\"language-text\">addLog</code> è¢«å­ç»„ä»¶è°ƒç”¨ï¼Œå¯¼è‡´ <code class=\"language-text\">LogProvider</code>é‡æ¸²æŸ“ä¹‹åï¼Œå¿…ç„¶ä¼šå¯¼è‡´ä¼ é€’ç»™ Provider çš„ value å‘ç”Ÿæ”¹å˜ï¼Œç”±äº value åŒ…å«äº† <code class=\"language-text\">logs</code> å’Œ <code class=\"language-text\">setLogs</code> å±æ€§ï¼Œæ‰€ä»¥ä¸¤è€…ä¸­ä»»æ„ä¸€ä¸ªå‘ç”Ÿå˜åŒ–ï¼Œéƒ½ä¼šå¯¼è‡´æ‰€æœ‰çš„è®¢é˜…äº† <code class=\"language-text\">LogProvider</code> çš„å­ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚</p>\n<p>é‚£ä¹ˆè§£å†³åŠæ³•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿå…¶å®å°±æ˜¯<strong>è¯»å†™åˆ†ç¦»</strong>ï¼Œæˆ‘ä»¬æŠŠ <code class=\"language-text\">logs</code>ï¼ˆè¯»ï¼‰å’Œ <code class=\"language-text\">setLogs</code>ï¼ˆå†™ï¼‰åˆ†åˆ«é€šè¿‡ä¸åŒçš„ Provider ä¼ é€’ï¼Œè¿™æ ·è´Ÿè´£å†™å…¥çš„ç»„ä»¶æ›´æ”¹äº† <code class=\"language-text\">logs</code>ï¼Œå…¶ä»–çš„ã€Œå†™ç»„ä»¶ã€å¹¶ä¸ä¼šé‡æ–°æ¸²æŸ“ï¼Œåªæœ‰çœŸæ­£å…³å¿ƒ <code class=\"language-text\">logs</code> çš„ã€Œè¯»ç»„ä»¶ã€ä¼šé‡æ–°æ¸²æŸ“ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">LogProvider</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> children <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>logs<span class=\"token punctuation\">,</span> setLogs<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> addLog <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span>log <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setLogs</span><span class=\"token punctuation\">(</span>prevLogs <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>prevLogs<span class=\"token punctuation\">,</span> log<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>LogDispatcherContext<span class=\"token punctuation\">.</span>Provider value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>addLog<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>LogStateContext<span class=\"token punctuation\">.</span>Provider value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>logs<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>LogStateContext<span class=\"token punctuation\">.</span>Provider<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>LogDispatcherContext<span class=\"token punctuation\">.</span>Provider<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æˆ‘ä»¬åˆšåˆšä¹Ÿæåˆ°ï¼Œéœ€è¦ä¿è¯ value çš„å¼•ç”¨ä¸èƒ½å‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥è¿™é‡Œè‡ªç„¶è¦ç”¨ <code class=\"language-text\">useCallback</code> æŠŠ <code class=\"language-text\">addLog</code> æ–¹æ³•åŒ…è£¹èµ·æ¥ï¼Œæ‰èƒ½ä¿è¯ <code class=\"language-text\">LogProvider</code> é‡æ¸²æŸ“çš„æ—¶å€™ï¼Œä¼ é€’ç»™çš„<code class=\"language-text\">LogDispatcherContext</code>çš„ value ä¸å‘ç”Ÿå˜åŒ–ã€‚</p>\n<p>ç°åœ¨æˆ‘ä»ä»»æ„ã€Œå†™ç»„ä»¶ã€å‘é€æ—¥å¿—ï¼Œéƒ½åªä¼šè®©ã€Œè¯»ç»„ä»¶ã€<code class=\"language-text\">LogsPanel</code> æ¸²æŸ“ã€‚</p>\n<p><img src=\"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/361989107b8d46c2921f7e8db1016d2c~tplv-k3u1fbpfcp-watermark.image\"></p>\n<p><a href=\"https://codesandbox.io/s/react-genghaodecontext-forked-l20yc\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Context è¯»å†™åˆ†ç¦» - åœ¨çº¿è°ƒè¯•</a></p>\n<h2 id=\"context-ä»£ç ç»„ç»‡\"><a href=\"#context-%E4%BB%A3%E7%A0%81%E7%BB%84%E7%BB%87\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Context ä»£ç ç»„ç»‡</h2>\n<p>ä¸Šé¢çš„æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬åœ¨å­ç»„ä»¶ä¸­è·å–å…¨å±€çŠ¶æ€ï¼Œéƒ½æ˜¯ç›´æ¥è£¸ç”¨ <code class=\"language-text\">useContext</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> LogStateContext <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./context'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> logs <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>LogStateContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä½†æ˜¯æ˜¯å¦æœ‰æ›´å¥½çš„ä»£ç ç»„ç»‡æ–¹æ³•å‘¢ï¼Ÿæ¯”å¦‚è¿™æ ·ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useLogState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./context'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> logs <span class=\"token operator\">=</span> <span class=\"token function\">useLogState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// context</span>\n<span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> LogStateContext <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">useLogState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>LogStateContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>åœ¨åŠ ä¸Šç‚¹å¥å£®æ€§ä¿è¯ï¼Ÿ</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> LogStateContext <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> LogDispatcherContext <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">createContext</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">useLogState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> context <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>LogStateContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>context <span class=\"token operator\">===</span> undefined<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">'useLogState must be used within a LogStateProvider'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> context<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">useLogDispatcher</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> context <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">useContext</span><span class=\"token punctuation\">(</span>LogDispatcherContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>context <span class=\"token operator\">===</span> undefined<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span>\n      <span class=\"token string\">'useLogDispatcher must be used within a LogDispatcherContext'</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> context<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å¦‚æœæœ‰çš„ç»„ä»¶åŒæ—¶éœ€è¦è¯»å†™æ—¥å¿—ï¼Œè°ƒç”¨ä¸¤æ¬¡å¾ˆéº»çƒ¦ï¼Ÿ</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">useLogs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token function\">useLogState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">useLogDispatcher</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>logs<span class=\"token punctuation\">,</span> addLogs<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useLogs</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æ ¹æ®åœºæ™¯ï¼Œçµæ´»è¿ç”¨è¿™äº›æŠ€å·§ï¼Œè®©ä½ çš„ä»£ç æ›´åŠ å¥å£®ä¼˜é›…~</p>\n<h2 id=\"ç»„åˆ-providers\"><a href=\"#%E7%BB%84%E5%90%88-providers\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç»„åˆ Providers</h2>\n<p>å‡è®¾æˆ‘ä»¬ä½¿ç”¨ä¸Šé¢çš„åŠæ³•ç®¡ç†ä¸€äº›å…¨å±€çš„å°çŠ¶æ€ï¼ŒProvider å˜çš„è¶Šæ¥è¶Šå¤šäº†ï¼Œæœ‰æ—¶å€™ä¼šé‡åˆ°åµŒå¥—åœ°ç‹±çš„æƒ…å†µï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">StateProviders</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> children <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>LogProvider<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>UserProvider<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>MenuProvider<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>AppProvider<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>AppProvider<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>MenuProvider<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>UserProvider<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>LogProvider<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>StateProviders<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Main <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>StateProviders<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æœ‰æ²¡æœ‰åŠæ³•è§£å†³å‘¢ï¼Ÿå½“ç„¶æœ‰ï¼Œæˆ‘ä»¬å‚è€ƒ <code class=\"language-text\">redux</code> ä¸­çš„ <code class=\"language-text\">compose</code> æ–¹æ³•ï¼Œè‡ªå·±å†™ä¸€ä¸ª <code class=\"language-text\">composeProvider</code> æ–¹æ³•ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">composeProviders</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>providers<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> children <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n    providers<span class=\"token punctuation\">.</span><span class=\"token function\">reduce</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>prev<span class=\"token punctuation\">,</span> Provider<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>Provider<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>prev<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Provider<span class=\"token operator\">></span><span class=\"token punctuation\">,</span> children<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä»£ç å°±å¯ä»¥ç®€åŒ–æˆè¿™æ ·ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> CombinedProviders <span class=\"token operator\">=</span> <span class=\"token function\">composeProviders</span><span class=\"token punctuation\">(</span>\n  LogProvider<span class=\"token punctuation\">,</span>\n  UserProvider<span class=\"token punctuation\">,</span>\n  MenuProvider<span class=\"token punctuation\">,</span>\n  AppProvider\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">App</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>StateProvider<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Main <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Provider<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"æ€»ç»“\"><a href=\"#%E6%80%BB%E7%BB%93\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æ€»ç»“</h2>\n<p>æœ¬ç¯‡æ–‡ç« ä¸»è¦å›´ç»•è¿™ Context è¿™ä¸ª APIï¼Œè®²äº†å‡ ä¸ªæ€§èƒ½ä¼˜åŒ–å’Œä»£ç ç»„ç»‡çš„ä¼˜åŒ–ç‚¹ï¼Œæ€»ç»“ä¸‹æ¥å°±æ˜¯ï¼š</p>\n<ol>\n<li>å°½é‡æå‡æ¸²æŸ“æ— å…³çš„å­ç»„ä»¶å…ƒç´ åˆ°ã€Œæœ‰çŠ¶æ€ç»„ä»¶ã€çš„å¤–éƒ¨ã€‚</li>\n<li>åœ¨éœ€è¦çš„æƒ…å†µä¸‹å¯¹ Context è¿›è¡Œè¯»å†™åˆ†ç¦»ã€‚</li>\n<li>åŒ…è£… Context çš„ä½¿ç”¨ï¼Œæ³¨æ„é”™è¯¯å¤„ç†ã€‚</li>\n<li>ç»„åˆå¤šä¸ª Contextï¼Œä¼˜åŒ–ä»£ç ã€‚</li>\n</ol>\n<p>æ¬¢è¿å…³æ³¨ã€Œ<strong>å‰ç«¯ä»è¿›é˜¶åˆ°å…¥é™¢</strong>ã€ï¼Œè¿˜æœ‰å¾ˆå¤šå‰ç«¯åŸåˆ›æ–‡ç« å“¦~</p>","timeToRead":9,"frontmatter":{"title":"æˆ‘åœ¨å·¥ä½œä¸­å†™ React å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿæ€§èƒ½ä¼˜åŒ–ç¯‡ã€‚","date":"October 29, 2020","spoiler":""},"fields":{"slug":"/732158430/","langKey":"en"}}},"pageContext":{"slug":"/732158430/","previous":{"fields":{"slug":"/725558322/","langKey":"en","directoryName":"725558322"},"frontmatter":{"title":"æˆ‘åœ¨å·¥ä½œä¸­å†™ React å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ"}},"next":{"fields":{"slug":"/744482423/","langKey":"en","directoryName":"744482423"},"frontmatter":{"title":"å­—èŠ‚è·³åŠ¨æ‹›äººå•¦"}},"translations":[],"translatedLinks":[]}},"staticQueryHashes":["336482444"]}