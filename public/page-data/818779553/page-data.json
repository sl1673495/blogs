{"componentChunkName":"component---src-templates-blog-post-js","path":"/818779553/","result":{"data":{"site":{"siteMetadata":{"title":"sshçš„åšå®¢","author":"ssh"}},"markdownRemark":{"id":"564a9910-61df-5407-8683-5af8c51b33f1","html":"<p>åœ¨ä¸šåŠ¡éœ€æ±‚ä¸­ï¼Œæœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦åŸºäº antd ä¹‹ç±»çš„ç»„ä»¶åº“å®šåˆ¶å¾ˆå¤šåŠŸèƒ½ï¼Œæœ¬æ–‡å°±ä»¥æˆ‘è‡ªå·±é‡åˆ°çš„ä¸šåŠ¡éœ€æ±‚ä¸ºä¾‹ï¼Œä¸€æ­¥æ­¥å®ç°å’Œä¼˜åŒ–ä¸€ä¸ªæ ‘çŠ¶è¡¨æ ¼ç»„ä»¶ï¼Œè¿™ä¸ªç»„ä»¶ä¼šæ”¯æŒï¼š</p>\n<ul>\n<li>âœ¨ æ¯ä¸ªå±‚çº§<strong>ç¼©è¿›æŒ‡ç¤ºçº¿</strong></li>\n<li>âœ¨ è¿œç¨‹<strong>æ‡’åŠ è½½</strong>å­èŠ‚ç‚¹</li>\n<li>âœ¨ æ¯ä¸ªå±‚çº§æ”¯æŒ<strong>åˆ†é¡µ</strong></li>\n</ul>\n<p>å¦‚æœä»…ä»…æ˜¯è¿™äº›ç›¸å¯¹å¸¸è§ä¸šåŠ¡åŠŸèƒ½ï¼Œå…¶å®æˆ‘ä¹Ÿä¸æƒ³å•°å—¦çš„å†™æˆä¸€ç¯‡æ–‡ç« ã€‚</p>\n<p>åœ¨è¿™ä¸ªç»„ä»¶å†™åˆ°åé¢åŠŸèƒ½è¶Šæ¥è¶Šå¤šè‡ƒè‚¿çš„æ—¶å€™ï¼Œæˆ‘å‘ç°å·²ç»å„ä¸ªåŠŸèƒ½æ‰€éœ€è¦çš„ä»£ç ä¸œä¸€å †ã€è¥¿ä¸€å †ï¼Œç»„ä»¶å·²ç»å˜å¾—å¾ˆéš¾ç»´æŠ¤äº†ã€‚</p>\n<p>ä¸€ä¸ªå‡½æ•°é‡Œå¯èƒ½æ—¢æœ‰æ‡’åŠ è½½éœ€è¦çš„é€»è¾‘ï¼Œåˆæœ‰åˆ†é¡µéœ€è¦çš„é€»è¾‘ï¼Œæ›´ä¸æ•¢æƒ³è±¡å†ç»§ç»­åŠ åŠŸèƒ½æ—¶å€™çš„ç—›è‹¦ã€‚</p>\n<p>è¿™æ—¶å€™æˆ‘å°±æƒ³ï¼Œç¤¾åŒºçŸ¥åçš„æ¡†æ¶éƒ½æ˜¯æ€ä¹ˆè§£å†³è€¦åˆæœºåˆ¶çš„å‘¢ï¼Ÿ<strong>æ’ä»¶</strong>è¿™ä¸ªè¯è¿›å…¥äº†æˆ‘çš„è„‘æµ·ï¼Œæ²¡é”™ï¼Œæ­£æ˜¯æ’ä»¶æœºåˆ¶æŠŠå„ç§å„æ ·é€»è¾‘ä»ä¸»æ¡†æ¶ä¸­<strong>è§£è€¦</strong>å‡ºæ¥ã€‚</p>\n<p>æ‰€ä»¥æœ¬æ–‡æˆ‘æƒ³é‡ç‚¹è®²çš„æ˜¯ï¼Œæ€ä¹ˆç»™<strong>ç»„ä»¶</strong>ä¹Ÿè®¾è®¡ä¸€å¥—ç®€å•çš„<strong>æ’ä»¶æœºåˆ¶</strong>ï¼Œæ¥è§£å†³ä»£ç è€¦åˆï¼Œéš¾ä»¥ç»´æŠ¤çš„é—®é¢˜ã€‚</p>\n<p>ä¸šåŠ¡åŠŸèƒ½å®ç°çš„éƒ¨åˆ†ä½œä¸ºå¼•å­ï¼Œç®€å•çœ‹çœ‹å³å¯ã€‚</p>\n<h2 id=\"åŠŸèƒ½å®ç°\"><a href=\"#%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>åŠŸèƒ½å®ç°</h2>\n<h3 id=\"å±‚çº§ç¼©è¿›çº¿\"><a href=\"#%E5%B1%82%E7%BA%A7%E7%BC%A9%E8%BF%9B%E7%BA%BF\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>å±‚çº§ç¼©è¿›çº¿</h3>\n<p>antd çš„ <a href=\"https://3x.ant.design/components/table-cn/#components-table-demo-dynamic-settings\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Table ç»„ä»¶</a> é»˜è®¤æ˜¯æ²¡æœ‰æä¾›è¿™ä¸ªåŠŸèƒ½çš„ï¼Œå®ƒåªæ˜¯æ”¯æŒäº†æ ‘çŠ¶ç»“æ„ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> treeData <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    function_name<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`React Tree Reconciliation`</span></span><span class=\"token punctuation\">,</span>\n    count<span class=\"token punctuation\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span>\n    children<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        function_name<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`React Tree Reconciliation2`</span></span><span class=\"token punctuation\">,</span>\n        count<span class=\"token punctuation\">:</span> <span class=\"token number\">100</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>å±•ç¤ºæ•ˆæœå¦‚ä¸‹ï¼š</p>\n<p><img src=\"https://images.gitee.com/uploads/images/2021/0301/164843_ed628f6e_1087321.png\" alt=\"antd-table\" title=\"å±å¹•æˆªå›¾.png\"></p>\n<p>å¯ä»¥çœ‹å‡ºï¼Œåœ¨å±•ç¤º<strong>å¤§é‡çš„å‡½æ•°å †æ ˆ</strong>çš„æ—¶å€™ï¼Œæ²¡æœ‰ç¼©è¿›çº¿å°±ä¼šå¾ˆéš¾å—äº†ï¼Œä¸šåŠ¡æ–¹ä¹Ÿç¡®å®å’Œæˆ‘æè¿‡è¿™ä¸ªéœ€æ±‚ï¼Œå¯æƒœä¹‹å‰å¤ªå¿™äº†ï¼Œå°±æš‚æ—¶æ”¾ä¸€è¾¹äº†ã€‚ğŸ˜</p>\n<p>å‚è€ƒ VSCode ä¸­çš„ç¼©è¿›çº¿æ•ˆæœï¼Œå¯ä»¥å‘ç°ï¼Œç¼©è¿›çº¿æ˜¯å’ŒèŠ‚ç‚¹çš„å±‚çº§ç´§å¯†ç›¸å…³çš„ã€‚</p>\n<p><img src=\"https://images.gitee.com/uploads/images/2021/0301/165157_dd33ae27_1087321.png\" alt=\"vscode\" title=\"å±å¹•æˆªå›¾.png\"></p>\n<p>æ¯”å¦‚ <code class=\"language-text\">src</code> ç›®å½•å¯¹åº”çš„æ˜¯ç¬¬ä¸€çº§ï¼Œé‚£ä¹ˆå®ƒçš„å­çº§ <code class=\"language-text\">client</code> å’Œ <code class=\"language-text\">node</code> å°±åªéœ€è¦åœ¨ td å‰é¢ç»˜åˆ¶ä¸€æ¡å‚ç›´çº¿ï¼Œè€Œ <code class=\"language-text\">node</code> ä¸‹çš„ä¸‰ä¸ªç›®å½•åˆ™ç»˜åˆ¶ä¸¤æ¡å‚ç›´çº¿ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ç¬¬ 1 å±‚ï¼š | text\nç¬¬ 2 å±‚ï¼š | | text\nç¬¬ 3 å±‚ï¼š | | | text</code></pre></div>\n<p>åªéœ€è¦åœ¨è‡ªå®šä¹‰æ¸²æŸ“å•å…ƒæ ¼å…ƒç´ çš„æ—¶å€™ï¼Œå¾—åˆ°ä»¥ä¸‹ä¸¤ä¸ªä¿¡æ¯ã€‚</p>\n<ol>\n<li>å½“å‰èŠ‚ç‚¹çš„å±‚çº§ä¿¡æ¯ã€‚</li>\n<li>å½“å‰èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹æ˜¯å¦æ˜¯å±•å¼€çŠ¶æ€ã€‚</li>\n</ol>\n<p>æ‰€ä»¥æ€è·¯å°±æ˜¯å¯¹æ•°æ®è¿›è¡Œä¸€æ¬¡<strong>é€’å½’å¤„ç†</strong>ï¼ŒæŠŠ<strong>å±‚çº§</strong>å†™åœ¨èŠ‚ç‚¹ä¸Šï¼Œå¹¶ä¸”è¦æŠŠ<strong>çˆ¶èŠ‚ç‚¹çš„å¼•ç”¨</strong>ä¹Ÿå†™ä¸Šï¼Œä¹‹åå†é€šè¿‡ä¼ ç»™ <code class=\"language-text\">Table</code> çš„ <code class=\"language-text\">expandedRowKeys</code> å±æ€§æ¥ç»´æŠ¤è¡¨æ ¼çš„å±•å¼€è¡Œæ•°æ®ã€‚</p>\n<p>è¿™é‡Œæˆ‘æ˜¯ç›´æ¥æ”¹å†™äº†åŸå§‹æ•°æ®ï¼Œå¦‚æœéœ€è¦ä¿è¯åŸå§‹æ•°æ®å¹²å‡€çš„è¯ï¼Œä¹Ÿå¯ä»¥å‚è€ƒ React Fiber çš„æ€è·¯ï¼Œæ„å»ºä¸€é¢—æ›¿èº«æ ‘è¿›è¡Œæ•°æ®å†™å…¥ï¼Œåªè¦ä¿ç•™åŸå§‹æ ‘èŠ‚ç‚¹çš„å¼•ç”¨å³å¯ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">/**\n * é€’å½’æ ‘çš„é€šç”¨å‡½æ•°\n */</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">traverseTree</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n  treeList<span class=\"token punctuation\">,</span>\n  childrenColumnName<span class=\"token punctuation\">,</span>\n  callback\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">traverse</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">,</span> parent <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> level <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    list<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>treeNode <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span>treeNode<span class=\"token punctuation\">,</span> parent<span class=\"token punctuation\">,</span> level<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>childrenColumnName<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> next <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> treeNode<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">isArray</span><span class=\"token punctuation\">(</span>next<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>next<span class=\"token punctuation\">,</span> treeNode<span class=\"token punctuation\">,</span> level <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">traverse</span><span class=\"token punctuation\">(</span>treeList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">rewriteTree</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> dataSource <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">traverseTree</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">,</span> childrenColumnName<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">,</span> parent<span class=\"token punctuation\">,</span> level<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// è®°å½•èŠ‚ç‚¹çš„å±‚çº§</span>\n    node<span class=\"token punctuation\">[</span><span class=\"token constant\">INTERNAL_LEVEL</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> level\n    <span class=\"token comment\">// è®°å½•èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</span>\n    node<span class=\"token punctuation\">[</span><span class=\"token constant\">INTERNAL_PARENT</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> parent\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä¹‹ååˆ©ç”¨ Table ç»„ä»¶æä¾›çš„ <code class=\"language-text\">components</code> å±æ€§ï¼Œè‡ªå®šä¹‰æ¸²æŸ“ <code class=\"language-text\">Cell</code> ç»„ä»¶ï¼Œä¹Ÿå°±æ˜¯ td å…ƒç´ ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> components <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  body<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    cell<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>cellProps<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>TreeTableCell\n        <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>props<span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">{</span><span class=\"token operator\">...</span>cellProps<span class=\"token punctuation\">}</span>\n        expandedRowKeys<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>expandedRowKeys<span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä¹‹åï¼Œåœ¨è‡ªå®šä¹‰æ¸²æŸ“çš„ Cell ä¸­ï¼Œåªéœ€è¦è·å–ä¸¤ä¸ªä¿¡æ¯ï¼Œåªéœ€è¦æ ¹æ®å±‚çº§å’Œçˆ¶èŠ‚ç‚¹çš„å±•å¼€çŠ¶æ€ï¼Œæ¥å†³å®šç»˜åˆ¶å‡ æ¡å‚ç›´çº¿å³å¯ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> isParentExpanded <span class=\"token operator\">=</span> expandedRowKeys<span class=\"token punctuation\">.</span><span class=\"token function\">includes</span><span class=\"token punctuation\">(</span>\n  record<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span><span class=\"token constant\">INTERNAL_PARENT</span><span class=\"token punctuation\">]</span><span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span>rowKey<span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// åªæœ‰å½“å‰æ˜¯å±•ç¤ºæŒ‡å¼•çº¿çš„åˆ— ä¸”çˆ¶èŠ‚ç‚¹æ˜¯å±•å¼€èŠ‚ç‚¹ æ‰ä¼šå±•ç¤ºç¼©è¿›æŒ‡å¼•çº¿</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>dataIndex <span class=\"token operator\">!==</span> indentLineDataIndex <span class=\"token operator\">||</span> <span class=\"token operator\">!</span>isParentExpanded<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>td className<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>className<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>td<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">// åªè¦çŸ¥é“å±‚çº§ å°±çŸ¥é“è¦åœ¨ td ä¸­ç»˜åˆ¶å‡ æ¡å‚ç›´æŒ‡å¼•çº¿ ä¸¾ä¾‹æ¥è¯´ï¼š</span>\n<span class=\"token comment\">// ç¬¬ 2 å±‚ï¼š | | text</span>\n<span class=\"token comment\">// ç¬¬ 3 å±‚ï¼š | | | text</span>\n<span class=\"token keyword\">const</span> level <span class=\"token operator\">=</span> record<span class=\"token punctuation\">[</span><span class=\"token constant\">INTERNAL_LEVEL</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token keyword\">const</span> indentLines <span class=\"token operator\">=</span> <span class=\"token function\">renderIndentLines</span><span class=\"token punctuation\">(</span>level<span class=\"token punctuation\">)</span></code></pre></div>\n<p>è¿™é‡Œçš„å®ç°å°±ä¸å†èµ˜è¿°ï¼Œç›´æ¥é€šè¿‡ç»å¯¹å®šä½ç”»å‡ æ¡å‚ç›´çº¿ï¼Œå†é€šè¿‡å¯¹ <code class=\"language-text\">level</code> è¿›è¡Œå¾ªç¯æ—¶çš„ä¸‹æ ‡ <code class=\"language-text\">index</code> å†³å®š <code class=\"language-text\">left</code> çš„åç§»å€¼å³å¯ã€‚</p>\n<p>æ•ˆæœå¦‚å›¾æ‰€ç¤ºï¼š</p>\n<p><img src=\"https://images.gitee.com/uploads/images/2021/0301/170832_0c4380cd_1087321.png\" alt=\"ç¼©è¿›çº¿\" title=\"å±å¹•æˆªå›¾.png\"></p>\n<h3 id=\"è¿œç¨‹æ‡’åŠ è½½å­èŠ‚ç‚¹\"><a href=\"#%E8%BF%9C%E7%A8%8B%E6%87%92%E5%8A%A0%E8%BD%BD%E5%AD%90%E8%8A%82%E7%82%B9\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>è¿œç¨‹æ‡’åŠ è½½å­èŠ‚ç‚¹</h3>\n<p>è¿™ä¸ªéœ€æ±‚å°±éœ€è¦ç”¨æ¯”è¾ƒ hack çš„æ‰‹æ®µå®ç°äº†ï¼Œé¦–å…ˆè§‚å¯Ÿäº†ä¸€ä¸‹ Table ç»„ä»¶çš„é€»è¾‘ï¼Œåªæœ‰åœ¨æœ‰ <code class=\"language-text\">children</code> çš„å­èŠ‚ç‚¹ä¸Šæ‰ä¼šå±•ç¤ºã€Œå±•å¼€æ›´å¤šã€çš„å›¾æ ‡ã€‚</p>\n<p>æ‰€ä»¥æ€è·¯å°±æ˜¯ï¼Œå’Œåç«¯çº¦å®šä¸€ä¸ªå­—æ®µæ¯”å¦‚ <code class=\"language-text\">has_next</code>ï¼Œä¹‹åé¢„å¤„ç†æ•°æ®çš„æ—¶å€™å…ˆéå†è¿™äº›èŠ‚ç‚¹ï¼ŒåŠ ä¸Šä¸€ä¸ªå‡çš„å ä½ <code class=\"language-text\">children</code>ã€‚</p>\n<p>ä¹‹ååœ¨ç‚¹å‡»å±•å¼€çš„æ—¶å€™ï¼ŒæŠŠèŠ‚ç‚¹ä¸Šçš„è¿™ä¸ªå‡ <code class=\"language-text\">children</code> åˆ é™¤æ‰ï¼Œå¹¶ä¸”æŠŠé€šè¿‡æ”¹å†™èŠ‚ç‚¹ä¸Šä¸€ä¸ªç‰¹æ®Šçš„ <code class=\"language-text\">is_loading</code> å­—æ®µï¼Œåœ¨è‡ªå®šä¹‰æ¸²æŸ“ Icon çš„ä»£ç ä¸­åˆ¤æ–­ï¼Œå¹¶ä¸”å±•ç¤º <code class=\"language-text\">Loading Icon</code>ã€‚</p>\n<p>åˆæ¥åˆ°é€’å½’æ ‘çš„é€»è¾‘ä¸­ï¼Œæˆ‘ä»¬åŠ å…¥è¿™æ ·çš„ä¸€æ®µä»£ç ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">rewriteTree</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> dataSource <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">traverseTree</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">,</span> childrenColumnName<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">,</span> parent<span class=\"token punctuation\">,</span> level<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">[</span>hasNextKey<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// æ ‘è¡¨æ ¼ç»„ä»¶è¦æ±‚ next å¿…é¡»æ˜¯éç©ºæ•°ç»„æ‰ä¼šæ¸²æŸ“ã€Œå±•å¼€æŒ‰é’®ã€</span>\n      <span class=\"token comment\">// æ‰€ä»¥è¿™é‡Œæ‰‹åŠ¨æ·»åŠ ä¸€ä¸ªå ä½èŠ‚ç‚¹æ•°ç»„</span>\n      <span class=\"token comment\">// åç»­åœ¨ onExpand çš„æ—¶å€™å†åŠ è½½æ›´å¤šèŠ‚ç‚¹ å¹¶ä¸”æ›¿æ¢è¿™ä¸ªæ•°ç»„</span>\n      node<span class=\"token punctuation\">[</span>childrenColumnName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token function\">generateInternalLoadingNode</span><span class=\"token punctuation\">(</span>rowKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä¹‹åæˆ‘ä»¬è¦å®ç°ä¸€ä¸ª <code class=\"language-text\">forceUpdate</code> å‡½æ•°ï¼Œé©±åŠ¨ç»„ä»¶å¼ºåˆ¶æ¸²æŸ“ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>_<span class=\"token punctuation\">,</span> forceUpdate<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useReducer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> x <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>å†æ¥åˆ° <code class=\"language-text\">onExpand</code> çš„é€»è¾‘ä¸­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> onExpand <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>expanded<span class=\"token punctuation\">,</span> record<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>expanded <span class=\"token operator\">&amp;&amp;</span> record<span class=\"token punctuation\">[</span>hasNextKey<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> onLoadMore<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// æ ‡è¯†èŠ‚ç‚¹çš„ loading</span>\n    record<span class=\"token punctuation\">[</span><span class=\"token constant\">INTERNAL_IS_LOADING</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span>\n    <span class=\"token comment\">// ç§»é™¤ç”¨æ¥å±•ç¤ºå±•å¼€ç®­å¤´çš„å‡ children</span>\n    record<span class=\"token punctuation\">[</span>childrenColumnName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n    <span class=\"token function\">forceUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> childList <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">onLoadMore</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">)</span>\n    record<span class=\"token punctuation\">[</span>hasNextKey<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>\n    <span class=\"token function\">addChildList</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">,</span> childList<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  onExpandProp<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>expanded<span class=\"token punctuation\">,</span> record<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">addChildList</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">,</span> childList<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  record<span class=\"token punctuation\">[</span>childrenColumnName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> childList\n  record<span class=\"token punctuation\">[</span><span class=\"token constant\">INTERNAL_IS_LOADING</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span>\n  <span class=\"token function\">rewriteTree</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    dataSource<span class=\"token punctuation\">:</span> childList<span class=\"token punctuation\">,</span>\n    parentNode<span class=\"token punctuation\">:</span> record\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">forceUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¿™é‡Œ <code class=\"language-text\">onLoadMore</code> æ˜¯ç”¨æˆ·ä¼ å…¥çš„è·å–æ›´å¤šå­èŠ‚ç‚¹çš„æ–¹æ³•ï¼Œ\nè¿™é‡Œæ¯”è¾ƒå®¹æ˜“ hack çš„åœ°æ–¹åœ¨äºï¼Œç»„ä»¶è¿›è¡Œå±•å¼€å…ˆç»™èŠ‚ç‚¹å†™å…¥ä¸€ä¸ªæ­£åœ¨åŠ è½½çš„æ ‡å¿—ï¼Œç„¶åå¼ºåˆ¶æ¸²æŸ“ï¼Œåœ¨åŠ è½½å®Œæˆåèµ‹å€¼äº†æ–°çš„å­èŠ‚ç‚¹ <code class=\"language-text\">record[childrenColumnName] = childList</code> åï¼Œæˆ‘ä»¬åˆé€šè¿‡ <code class=\"language-text\">forceUpdate</code> å»å¼ºåˆ¶ç»„ä»¶é‡æ¸²æŸ“ï¼Œå±•ç¤ºå‡ºæ–°çš„å­èŠ‚ç‚¹ã€‚</p>\n<p>éœ€è¦æ³¨æ„ï¼Œæˆ‘ä»¬é€’å½’æ ‘åŠ å…¥é€»è¾‘çš„æ‰€æœ‰é€»è¾‘éƒ½åœ¨ <code class=\"language-text\">rewriteTree</code> ä¸­ï¼Œæ‰€ä»¥å¯¹äºåŠ å…¥çš„æ–°çš„å­èŠ‚ç‚¹ï¼Œä¹Ÿéœ€è¦é€šè¿‡è¿™ä¸ªå‡½æ•°é€’å½’ä¸€éï¼ŒåŠ å…¥ <code class=\"language-text\">level</code>, <code class=\"language-text\">parent</code> ç­‰ä¿¡æ¯ã€‚</p>\n<p>æ–°åŠ å…¥çš„èŠ‚ç‚¹çš„ <code class=\"language-text\">level</code> éœ€è¦æ ¹æ®çˆ¶èŠ‚ç‚¹çš„ <code class=\"language-text\">level</code> ç›¸åŠ å¾—å‡ºï¼Œä¸èƒ½ä» 1 å¼€å§‹ï¼Œå¦åˆ™æ¸²æŸ“çš„ç¼©è¿›çº¿å°±ä¹±æ‰äº†ï¼Œæ‰€ä»¥è¿™ä¸ªå‡½æ•°éœ€è¦æ”¹å†™ï¼ŒåŠ å…¥ <code class=\"language-text\">parentNode</code> çˆ¶èŠ‚ç‚¹å‚æ•°ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">rewriteTree</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  dataSource<span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// åœ¨åŠ¨æ€è¿½åŠ å­æ ‘èŠ‚ç‚¹çš„æ—¶å€™ éœ€è¦æ‰‹åŠ¨ä¼ å…¥ parent å¼•ç”¨</span>\n  parentNode <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// åœ¨åŠ¨æ€è¿½åŠ å­æ ‘èŠ‚ç‚¹çš„æ—¶å€™ éœ€è¦æ‰‹åŠ¨ä¼ å…¥çˆ¶èŠ‚ç‚¹çš„ level å¦åˆ™ level ä¼šä» 1 å¼€å§‹è®¡ç®—</span>\n  <span class=\"token keyword\">const</span> startLevel <span class=\"token operator\">=</span> parentNode<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span><span class=\"token constant\">INTERNAL_LEVEL</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token number\">0</span>\n\n  <span class=\"token function\">traverseTree</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">,</span> childrenColumnName<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">,</span> parent<span class=\"token punctuation\">,</span> level<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// è®°å½•èŠ‚ç‚¹çš„å±‚çº§</span>\n    node<span class=\"token punctuation\">[</span><span class=\"token constant\">INTERNAL_LEVEL</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> level <span class=\"token operator\">+</span> startLevel\n    <span class=\"token comment\">// è®°å½•èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹</span>\n    node<span class=\"token punctuation\">[</span><span class=\"token constant\">INTERNAL_PARENT</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> parent <span class=\"token operator\">||</span> parentNode\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">[</span>hasNextKey<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// æ ‘è¡¨æ ¼ç»„ä»¶è¦æ±‚ next å¿…é¡»æ˜¯éç©ºæ•°ç»„æ‰ä¼šæ¸²æŸ“ã€Œå±•å¼€æŒ‰é’®ã€</span>\n      <span class=\"token comment\">// æ‰€ä»¥è¿™é‡Œæ‰‹åŠ¨æ·»åŠ ä¸€ä¸ªå ä½èŠ‚ç‚¹æ•°ç»„</span>\n      <span class=\"token comment\">// åç»­åœ¨ onExpand çš„æ—¶å€™å†åŠ è½½æ›´å¤šèŠ‚ç‚¹ å¹¶ä¸”æ›¿æ¢è¿™ä¸ªæ•°ç»„</span>\n      node<span class=\"token punctuation\">[</span>childrenColumnName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token function\">generateInternalLoadingNode</span><span class=\"token punctuation\">(</span>rowKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è‡ªå®šä¹‰æ¸²æŸ“ <code class=\"language-text\">Loading Icon</code> å°±å¾ˆç®€å•äº†ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// ä¼ å…¥ç»™ Table ç»„ä»¶çš„ expandIcon å±æ€§å³å¯</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">TreeTableExpandIcon</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  expanded<span class=\"token punctuation\">,</span>\n  expandable<span class=\"token punctuation\">,</span>\n  onExpand<span class=\"token punctuation\">,</span>\n  record\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">[</span><span class=\"token constant\">INTERNAL_IS_LOADING</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>IconLoading style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>iconStyle<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>åŠŸèƒ½å®Œæˆï¼Œçœ‹ä¸€ä¸‹æ•ˆæœï¼š</p>\n<p><img src=\"https://images.gitee.com/uploads/images/2021/0301/174811_ef09a28c_1087321.gif\" alt=\"è¿œç¨‹æ‡’åŠ è½½\" title=\"Kapture 2021-03-01 at 17.47.56.gif\"></p>\n<h2 id=\"æ¯ä¸ªå±‚çº§æ”¯æŒåˆ†é¡µ\"><a href=\"#%E6%AF%8F%E4%B8%AA%E5%B1%82%E7%BA%A7%E6%94%AF%E6%8C%81%E5%88%86%E9%A1%B5\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æ¯ä¸ªå±‚çº§æ”¯æŒåˆ†é¡µ</h2>\n<p>è¿™ä¸ªåŠŸèƒ½å’Œä¸Šä¸€ä¸ªåŠŸèƒ½ä¹Ÿæœ‰ç‚¹ç±»ä¼¼ï¼Œéœ€è¦åœ¨ <code class=\"language-text\">rewriteTree</code> çš„æ—¶å€™æ ¹æ®å¤–éƒ¨ä¼ å…¥çš„æ˜¯å¦å¼€å¯åˆ†é¡µçš„å­—æ®µï¼Œåœ¨ç¬¦åˆæ¡ä»¶çš„æ—¶å€™å¾€å­èŠ‚ç‚¹æ•°ç»„çš„æœ«å°¾åŠ å…¥ä¸€ä¸ª<strong>å ä½ Pagination èŠ‚ç‚¹</strong>ã€‚</p>\n<p>ä¹‹ååœ¨ <code class=\"language-text\">column</code> çš„ <code class=\"language-text\">render</code> ä¸­æ”¹å†™è¿™ä¸ªèŠ‚ç‚¹çš„æ¸²æŸ“é€»è¾‘ã€‚</p>\n<p>æ”¹å†™èŠ‚ç‚¹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">rewriteTree</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  dataSource<span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// åœ¨åŠ¨æ€è¿½åŠ å­æ ‘èŠ‚ç‚¹çš„æ—¶å€™ éœ€è¦æ‰‹åŠ¨ä¼ å…¥ parent å¼•ç”¨</span>\n  parentNode <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// åœ¨åŠ¨æ€è¿½åŠ å­æ ‘èŠ‚ç‚¹çš„æ—¶å€™ éœ€è¦æ‰‹åŠ¨ä¼ å…¥çˆ¶èŠ‚ç‚¹çš„ level å¦åˆ™ level ä¼šä» 1 å¼€å§‹è®¡ç®—</span>\n  <span class=\"token keyword\">const</span> startLevel <span class=\"token operator\">=</span> parentNode<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">[</span><span class=\"token constant\">INTERNAL_LEVEL</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> <span class=\"token number\">0</span>\n\n  <span class=\"token function\">traverseTree</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">,</span> childrenColumnName<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">,</span> parent<span class=\"token punctuation\">,</span> level<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// â€¦â€¦ä¹‹å‰çš„é€»è¾‘çœç•¥</span>\n\n    <span class=\"token comment\">// åˆ†é¡µé€»è¾‘</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>childrenPagination<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> totalKey <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> childrenPagination\n      <span class=\"token keyword\">const</span> nodeChildren <span class=\"token operator\">=</span> node<span class=\"token punctuation\">[</span>childrenColumnName<span class=\"token punctuation\">]</span>\n      <span class=\"token comment\">// æ¸²æŸ“åˆ†é¡µå™¨ï¼Œå…ˆåŠ å…¥å ä½èŠ‚ç‚¹</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n        node<span class=\"token punctuation\">[</span>totalKey<span class=\"token punctuation\">]</span> <span class=\"token operator\">></span> nodeChildren<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>length <span class=\"token operator\">&amp;&amp;</span>\n        <span class=\"token comment\">// é˜²æ­¢é‡å¤æ·»åŠ åˆ†é¡µå™¨å ä½ç¬¦</span>\n        <span class=\"token operator\">!</span><span class=\"token function\">isInternalPaginationNode</span><span class=\"token punctuation\">(</span>nodeChildren<span class=\"token punctuation\">[</span>nodeChildren<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> rowKey<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        nodeChildren<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>push<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span><span class=\"token function\">generateInternalPaginationNode</span><span class=\"token punctuation\">(</span>rowKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æ”¹å†™ <code class=\"language-text\">columns</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">rewriteColumns</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/**\n   * æ ¹æ®å ä½ç¬¦ æ¸²æŸ“åˆ†é¡µç»„ä»¶\n   */</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">rewritePaginationRender</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>column<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    column<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">render</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token function\">ColumnRender</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">,</span> record<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n        <span class=\"token function\">isInternalPaginationNode</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">,</span> rowKey<span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span>\n        dataIndex <span class=\"token operator\">===</span> indentLineDataIndex\n      <span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>Pagination <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">return</span> render<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">,</span> record<span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span> text\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  columns<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>column<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">rewritePaginationRender</span><span class=\"token punctuation\">(</span>column<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æ¥çœ‹ä¸€ä¸‹å®ç°çš„åˆ†é¡µæ•ˆæœï¼š\n<img src=\"https://images.gitee.com/uploads/images/2021/0301/181948_efc006a8_1087321.gif\" alt=\"åˆ†é¡µ\" title=\"Kapture 2021-03-01 at 18.19.38.gif\"></p>\n<h2 id=\"åˆ©ç”¨æ’ä»¶æœºåˆ¶é‡æ„\"><a href=\"#%E5%88%A9%E7%94%A8%E6%8F%92%E4%BB%B6%E6%9C%BA%E5%88%B6%E9%87%8D%E6%9E%84\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>åˆ©ç”¨æ’ä»¶æœºåˆ¶é‡æ„</h2>\n<p>åˆ°è¿™é‡Œæˆ‘ä»¬å·²ç»å¯ä»¥å‘ç°ï¼Œåˆ†é¡µç›¸å…³çš„é€»è¾‘è¢«åˆ†æ•£åœ¨ <code class=\"language-text\">rewriteTree</code> å’Œ <code class=\"language-text\">rewriteColumns</code> ä¸­ï¼Œè€ŒåŠ è½½æ›´å¤šçš„é€»è¾‘è¢«åˆ†æ•£åœ¨ <code class=\"language-text\">rewriteTree</code> å’Œ <code class=\"language-text\">onExpand</code> ä¸­ï¼Œç»„ä»¶çš„ä»£ç è¡Œæ•°ä¹Ÿå·²ç»æ¥åˆ°äº† <code class=\"language-text\">300</code> è¡Œã€‚</p>\n<p>å¤§æ¦‚çœ‹ä¸€ä¸‹ä»£ç çš„ç»“æ„ï¼Œå·²ç»æ˜¯æ¯”è¾ƒæ··ä¹±äº†ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">TreeTable</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>rawProps<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">rewriteTree</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// åŠ è½½æ›´å¤šé€»è¾‘</span>\n    <span class=\"token comment\">// åˆ†é¡µé€»è¾‘</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">rewriteColumns</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// åˆ†é¡µé€»è¾‘</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">const</span> onExpand <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>expanded<span class=\"token punctuation\">,</span> record<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// åŠ è½½æ›´å¤šé€»è¾‘</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>Table <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å›å¿†ä¸€ä¸‹ç¤¾åŒºä¸­ä¸€äº›å¼€æºæ¡†æ¶æä¾›çš„æ’ä»¶æœºåˆ¶ï¼Œæ¯”å¦‚ <a href=\"https://cn.vitejs.dev/guide/api-plugin.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Vite çš„æ’ä»¶</a>ã€<a href=\"https://webpack.docschina.org/concepts/plugins/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Webpack çš„æ’ä»¶</a> ç”šè‡³å¤§å®¶å¾ˆç†Ÿæ‚‰çš„ <a href=\"https://cn.vuejs.org/v2/api/#Vue-use\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Vue.use()</a>ï¼Œå®ƒä»¬æœ¬è´¨ä¸Šå¯¹å¤–æš´éœ²å‡ºä¸€äº›å†…éƒ¨çš„æ—¶æœºå’Œå±æ€§ï¼Œè®©ç”¨æˆ·å»å†™ä¸€äº›ä»£ç æ¥ä»‹å…¥æ¡†æ¶è¿è¡Œçš„å„ä¸ªæ—¶æœºä¹‹ä¸­ã€‚</p>\n<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬æ˜¯å¦å¯ä»¥è€ƒè™‘æŠŠã€Œå¤„ç†æ¯ä¸ªèŠ‚ç‚¹ã€<code class=\"language-text\">column</code>ã€æ¯æ¬¡ <code class=\"language-text\">onExpand</code>ã€ çš„æ—¶æœºæš´éœ²å‡ºå»ã€‚</p>\n<p>è¿™æ ·è®©ç”¨æˆ·ä¹Ÿå¯ä»¥ä»‹å…¥è¿™äº›æµç¨‹ï¼Œå»æ”¹å†™ä¸€äº›å±æ€§ï¼Œè°ƒç”¨ä¸€äº›å†…éƒ¨æ–¹æ³•ï¼Œä»¥æ­¤å®ç°ä¸Šé¢çš„å‡ ä¸ªåŠŸèƒ½å‘¢ï¼Ÿ</p>\n<p>æˆ‘ä»¬è®¾è®¡æ’ä»¶æœºåˆ¶ï¼Œæƒ³è¦å®ç°è¿™ä¸¤ä¸ªç›®æ ‡ï¼š</p>\n<ol>\n<li><strong>é€»è¾‘è§£è€¦</strong>ï¼ŒæŠŠæ¯ä¸ªå°åŠŸèƒ½çš„ä»£ç æ”¶ç¼©åˆ°æ’ä»¶æ–‡ä»¶ä¸­å»ï¼Œä¸å’Œç»„ä»¶è€¦åˆèµ·æ¥ï¼Œå¢åŠ å¯ç»´æŠ¤æ€§ã€‚</li>\n<li><strong>ç”¨æˆ·å…±å»º</strong>ï¼Œå†…éƒ¨ä½¿ç”¨çš„è¯åŒäº‹æ–¹ä¾¿å…±å»ºï¼Œå¼€æºåç¤¾åŒºæ–¹ä¾¿å…±å»ºï¼Œå½“ç„¶è¿™è¦æ±‚ä½ ç¼–å†™çš„æ’ä»¶æœºåˆ¶è¶³å¤Ÿå®Œå–„ï¼Œæ–‡æ¡£è¶³å¤Ÿå‹å¥½ã€‚</li>\n</ol>\n<p>å½“ç„¶æ’ä»¶ä¹Ÿä¼šå¸¦æ¥ä¸€äº›ç¼ºç‚¹ï¼Œè®¾è®¡ä¸€å¥—å®Œå–„çš„æ’ä»¶æœºåˆ¶ä¹Ÿæ˜¯éå¸¸å¤æ‚çš„ï¼Œåƒ Webpackã€Rollupã€Redux çš„æ’ä»¶æœºåˆ¶éƒ½æœ‰è®¾è®¡çš„éå¸¸ç²¾è‰¯çš„åœ°æ–¹å¯ä»¥å‚è€ƒå­¦ä¹ ã€‚</p>\n<p>ä¸è¿‡å›åˆ°æœ¬æ–‡ï¼Œæˆ‘åªæ˜¯å®ç°çš„ä¸€ä¸ªæœ€ç®€åŒ–ç‰ˆçš„æ’ä»¶ç³»ç»Ÿã€‚</p>\n<p>é¦–å…ˆï¼Œè®¾è®¡ä¸€ä¸‹æ’ä»¶çš„æ¥å£ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">TreeTablePlugin</span><span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span> <span class=\"token operator\">=</span> <span class=\"token builtin\">any</span><span class=\"token operator\">></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">:</span> ResolvedProps<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">:</span> TreeTablePluginContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n     * å¯ä»¥è®¿é—®åˆ°æ¯ä¸€ä¸ª column å¹¶ä¿®æ”¹\n     */</span>\n    onColumn<span class=\"token operator\">?</span><span class=\"token punctuation\">(</span>column<span class=\"token punctuation\">:</span> ColumnProps<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">void</span>\n    <span class=\"token comment\">/**\n     * å¯ä»¥è®¿é—®åˆ°æ¯ä¸€ä¸ªèŠ‚ç‚¹æ•°æ®\n     * åœ¨åˆå§‹åŒ–æˆ–è€…æ–°å¢å­èŠ‚ç‚¹ä»¥åéƒ½ä¼šæ‰§è¡Œ\n     */</span>\n    onRecord<span class=\"token operator\">?</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">void</span>\n    <span class=\"token comment\">/**\n     * èŠ‚ç‚¹å±•å¼€çš„å›è°ƒå‡½æ•°\n     */</span>\n    onExpand<span class=\"token operator\">?</span><span class=\"token punctuation\">(</span>expanded<span class=\"token punctuation\">,</span> record<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">void</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">interface</span> <span class=\"token class-name\">TreeTablePluginContext</span> <span class=\"token punctuation\">{</span>\n  forceUpdate<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span>DispatchWithoutAction<span class=\"token punctuation\">;</span>\n  <span class=\"token function\">addChildList</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">,</span> childList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n  expandedRowKeys<span class=\"token punctuation\">:</span> TableProps<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">></span><span class=\"token punctuation\">[</span><span class=\"token string\">'expandedRowKeys'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  setExpandedRowKeys<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>v<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">|</span> undefined<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æˆ‘æŠŠæ’ä»¶è®¾è®¡æˆä¸€ä¸ª<strong>å‡½æ•°</strong>ï¼Œè¿™æ ·æ¯æ¬¡æ‰§è¡Œéƒ½å¯ä»¥æ‹¿åˆ°æœ€æ–°çš„ <code class=\"language-text\">props</code> å’Œ <code class=\"language-text\">context</code>ã€‚</p>\n<p><code class=\"language-text\">context</code> å…¶å®å°±æ˜¯ç»„ä»¶å†…ä¸€äº›ä¾èµ–ä¸Šä¸‹æ–‡çš„å·¥å…·å‡½æ•°ç­‰ç­‰ï¼Œæ¯”å¦‚ <code class=\"language-text\">forceUpdate</code>, <code class=\"language-text\">addChildList</code> ç­‰å‡½æ•°éƒ½å¯ä»¥æŒ‚åœ¨ä¸Šé¢ã€‚</p>\n<p>æ¥ä¸‹æ¥ï¼Œç”±äºæ’ä»¶å¯èƒ½æœ‰å¤šä¸ªï¼Œè€Œä¸”å†…éƒ¨å¯èƒ½ä¼šæœ‰ä¸€äº›è§£ææµç¨‹ï¼Œæ‰€ä»¥æˆ‘è®¾è®¡ä¸€ä¸ªè¿è¡Œæ’ä»¶çš„ hook å‡½æ•° <code class=\"language-text\">usePluginContainer</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">usePluginContainer</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n  props<span class=\"token punctuation\">:</span> ResolvedProps<span class=\"token punctuation\">,</span>\n  context<span class=\"token punctuation\">:</span> TreeTablePluginContext\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> plugins<span class=\"token punctuation\">:</span> rawPlugins <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props\n\n  <span class=\"token keyword\">const</span> plugins <span class=\"token operator\">=</span> rawPlugins<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>plugin<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> plugin<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">,</span> context<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> container <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">onColumn</span><span class=\"token punctuation\">(</span>column<span class=\"token punctuation\">:</span> ColumnProps<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> plugin <span class=\"token keyword\">of</span> plugins<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        plugin<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>onColumn<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>column<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">onRecord</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> plugin <span class=\"token keyword\">of</span> plugins<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        plugin<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>onRecord<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>record<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token function\">onExpand</span><span class=\"token punctuation\">(</span>expanded<span class=\"token punctuation\">,</span> record<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> plugin <span class=\"token keyword\">of</span> plugins<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        plugin<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>onExpand<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span>expanded<span class=\"token punctuation\">,</span> record<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> container\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ç›®å‰çš„æµç¨‹å¾ˆç®€å•ï¼Œåªæ˜¯æŠŠæ¯ä¸ª <code class=\"language-text\">plugin</code> å‡½æ•°è°ƒç”¨ä¸€ä¸‹ï¼Œç„¶åæä¾›å¯¹å¤–çš„åŒ…è£…æ¥å£ã€‚</p>\n<p>æ¥ç€å°±å¯ä»¥åœ¨ç»„ä»¶ä¸­è°ƒç”¨è¿™ä¸ª hook å‡½æ•°ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> TreeTable<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token constant\">FC</span><span class=\"token operator\">&lt;</span>ITreeTableProps<span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>_<span class=\"token punctuation\">,</span> forceUpdate<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useReducer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> x <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>expandedRowKeys<span class=\"token punctuation\">,</span> setExpandedRowKeys<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> useControllableValue<span class=\"token operator\">&lt;</span>\n    TableProps<span class=\"token operator\">&lt;</span><span class=\"token builtin\">any</span><span class=\"token operator\">></span><span class=\"token punctuation\">[</span><span class=\"token string\">'expandedRowKeys'</span><span class=\"token punctuation\">]</span>\n  <span class=\"token operator\">></span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    defaultValue<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    valuePropName<span class=\"token punctuation\">:</span> <span class=\"token string\">'expandedRowKeys'</span><span class=\"token punctuation\">,</span>\n    trigger<span class=\"token punctuation\">:</span> <span class=\"token string\">'onExpandedRowsChange'</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> pluginContext <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    forceUpdate<span class=\"token punctuation\">,</span>\n    addChildList<span class=\"token punctuation\">,</span>\n    expandedRowKeys<span class=\"token punctuation\">,</span>\n    setExpandedRowKeys\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// è¿™é‡Œæ‹¿åˆ°äº† pluginContainer</span>\n  <span class=\"token keyword\">const</span> pluginContainer <span class=\"token operator\">=</span> <span class=\"token function\">usePluginContainer</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">,</span> pluginContext<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä¹‹åï¼Œåœ¨å„ä¸ªæµç¨‹çš„ç›¸åº”ä½ç½®ï¼Œéƒ½é€šè¿‡è¿™ä¸ª hook è¿”å›çš„å®ä¾‹æ¥æ‰§è¡Œç›¸åº”çš„å‡½æ•°å³å¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> TreeTable<span class=\"token punctuation\">:</span> React<span class=\"token punctuation\">.</span><span class=\"token constant\">FC</span><span class=\"token operator\">&lt;</span>ITreeTableProps<span class=\"token operator\">></span> <span class=\"token operator\">=</span> props <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">...</span>\n\n  <span class=\"token comment\">// è¿™é‡Œæ‹¿åˆ°äº† pluginContainer</span>\n  <span class=\"token keyword\">const</span> pluginContainer <span class=\"token operator\">=</span> <span class=\"token function\">usePluginContainer</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">,</span> pluginContext<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">/**\n   *  éœ€è¦å¯¹ dataSource è¿›è¡Œä¸€äº›æ”¹å†™ å¢åŠ å±‚çº§ã€çˆ¶èŠ‚ç‚¹ã€loading èŠ‚ç‚¹ã€åˆ†é¡µç­‰ä¿¡æ¯\n   */</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">rewriteTree</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    dataSource<span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// åœ¨åŠ¨æ€è¿½åŠ å­æ ‘èŠ‚ç‚¹çš„æ—¶å€™ éœ€è¦æ‰‹åŠ¨ä¼ å…¥ parent å¼•ç”¨</span>\n    parentNode <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    pluginContainer<span class=\"token punctuation\">.</span><span class=\"token function\">onRecord</span><span class=\"token punctuation\">(</span>parentNode<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token function\">traverseTree</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">,</span> childrenColumnName<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">,</span> parent<span class=\"token punctuation\">,</span> level<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      pluginContainer<span class=\"token punctuation\">.</span><span class=\"token function\">onRecord</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">function</span> <span class=\"token function\">rewriteColumns</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    columns<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>column <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      pluginContainer<span class=\"token punctuation\">.</span><span class=\"token function\">onColumn</span><span class=\"token punctuation\">(</span>column<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">const</span> onExpand <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>expanded<span class=\"token punctuation\">,</span> record<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    pluginContainer<span class=\"token punctuation\">.</span><span class=\"token function\">onExpand</span><span class=\"token punctuation\">(</span>expanded<span class=\"token punctuation\">,</span> record<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æŠŠä¹‹å‰<strong>åˆ†é¡µç›¸å…³</strong>çš„é€»è¾‘ç›´æ¥æŠ½è±¡æˆ <code class=\"language-text\">pagination-plugin</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> paginationPlugin<span class=\"token punctuation\">:</span> <span class=\"token function-variable function\">TreeTablePlugin</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n  props<span class=\"token punctuation\">:</span> ResolvedProps<span class=\"token punctuation\">,</span>\n  context<span class=\"token punctuation\">:</span> TreeTablePluginContext\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> forceUpdate<span class=\"token punctuation\">,</span> addChildList <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> context\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n    childrenPagination<span class=\"token punctuation\">,</span>\n    childrenColumnName<span class=\"token punctuation\">,</span>\n    rowKey<span class=\"token punctuation\">,</span>\n    indentLineDataIndex\n  <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handlePagination</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// å…ˆåŠ å…¥æ¸²æŸ“åˆ†é¡µå™¨å ä½èŠ‚ç‚¹</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">rewritePaginationRender</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>column<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// æ”¹å†™ column çš„ render</span>\n    <span class=\"token comment\">// æ¸²æŸ“åˆ†é¡µå™¨</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    onRecord<span class=\"token punctuation\">:</span> handlePagination<span class=\"token punctuation\">,</span>\n    onColumn<span class=\"token punctuation\">:</span> rewritePaginationRender\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è€Œ<strong>æ‡’åŠ è½½èŠ‚ç‚¹</strong>ç›¸å…³çš„é€»è¾‘ä¹Ÿå¯ä»¥æŠ½è±¡æˆ <code class=\"language-text\">lazyload-plugin</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"ts\"><pre class=\"language-ts\"><code class=\"language-ts\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> lazyloadPlugin<span class=\"token punctuation\">:</span> <span class=\"token function-variable function\">TreeTablePlugin</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>\n  props<span class=\"token punctuation\">:</span> ResolvedProps<span class=\"token punctuation\">,</span>\n  context<span class=\"token punctuation\">:</span> TreeTablePluginContext\n<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> childrenColumnName<span class=\"token punctuation\">,</span> rowKey<span class=\"token punctuation\">,</span> hasNextKey<span class=\"token punctuation\">,</span> onLoadMore <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> props\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> addChildList<span class=\"token punctuation\">,</span> expandedRowKeys<span class=\"token punctuation\">,</span> setExpandedRowKeys <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> context\n\n  <span class=\"token comment\">// å¤„ç†æ‡’åŠ è½½å ä½èŠ‚ç‚¹é€»è¾‘</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleNextLevelLoader</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">const</span> onExpand <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span>expanded<span class=\"token punctuation\">,</span> record<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>expanded <span class=\"token operator\">&amp;&amp;</span> record<span class=\"token punctuation\">[</span>hasNextKey<span class=\"token punctuation\">]</span> <span class=\"token operator\">&amp;&amp;</span> onLoadMore<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// å¤„ç†æ‡’åŠ è½½é€»è¾‘</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    onRecord<span class=\"token punctuation\">:</span> handleNextLevelLoader<span class=\"token punctuation\">,</span>\n    onExpand<span class=\"token punctuation\">:</span> onExpand\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è‡³æ­¤ï¼Œä¸»å‡½æ•°è¢«ç²¾ç®€åˆ° <code class=\"language-text\">150</code> è¡Œå·¦å³ï¼Œæ–°åŠŸèƒ½ç›¸å…³çš„å‡½æ•°å…¨éƒ¨è¢«ç§»åˆ°æ’ä»¶ç›®å½•ä¸­å»äº†ï¼Œæ— è®ºæ˜¯æƒ³è¦æ–°å¢æˆ–è€…åˆ å‡ã€å¼€å…³åŠŸèƒ½éƒ½å˜çš„éå¸¸å®¹æ˜“ã€‚</p>\n<p>æ­¤æ—¶çš„ç›®å½•ç»“æ„ï¼š</p>\n<p><img src=\"https://images.gitee.com/uploads/images/2021/0301/193435_38e8a9ba_1087321.png\" alt=\"ç›®å½•ç»“æ„\" title=\"å±å¹•æˆªå›¾.png\"></p>\n<h2 id=\"æ€»ç»“\"><a href=\"#%E6%80%BB%E7%BB%93\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æ€»ç»“</h2>\n<p>æœ¬æ–‡é€šè¿‡è®²è¿°æ‰©å±• <code class=\"language-text\">Table</code> ç»„ä»¶çš„å¦‚ä¸‹åŠŸèƒ½ï¼š</p>\n<ul>\n<li>âœ¨ æ¯ä¸ªå±‚çº§<strong>ç¼©è¿›æŒ‡ç¤ºçº¿</strong></li>\n<li>âœ¨ è¿œç¨‹<strong>æ‡’åŠ è½½</strong>å­èŠ‚ç‚¹</li>\n<li>âœ¨ æ¯ä¸ªå±‚çº§æ”¯æŒ<strong>åˆ†é¡µ</strong></li>\n</ul>\n<p>ä»¥åŠå¼€å‘è¿‡ç¨‹ä¸­å‡ºç°ä»£ç çš„è€¦åˆï¼Œéš¾ä»¥ç»´æŠ¤é—®é¢˜ï¼Œè¿›è€Œå»¶ä¼¸æ¢ç´¢<strong>æ’ä»¶æœºåˆ¶</strong>åœ¨ç»„ä»¶ä¸­çš„è®¾è®¡å’Œä½¿ç”¨ï¼Œè™½ç„¶æœ¬æ–‡è®¾è®¡çš„æ’ä»¶è¿˜æ˜¯æœ€ç®€é™‹çš„ç‰ˆæœ¬ï¼Œä½†æ˜¯åŸç†å¤§è‡´ä¸Šå¦‚æ­¤ï¼Œå¸Œæœ›èƒ½å¤Ÿå¯¹ä½ æœ‰æ‰€å¯å‘ã€‚</p>","timeToRead":13,"frontmatter":{"title":"é€šè¿‡è®¾è®¡ã€Œæ’ä»¶ã€æœºåˆ¶ï¼Œç»™  Table ç»„ä»¶ç¼–å†™ç¼©è¿›æŒ‡å¼•çº¿ã€æ‡’åŠ è½½ç­‰åŠŸèƒ½","date":"March 01, 2021","spoiler":""},"fields":{"slug":"/818779553/","langKey":"en"}}},"pageContext":{"slug":"/818779553/","previous":{"fields":{"slug":"/818217827/","langKey":"en","directoryName":"818217827"},"frontmatter":{"title":"TypeScript ä¸­ä½ ä¸ä¸€å®šçŸ¥é“çš„ top typesï¼Œåœ¨ç”¨ any ä¹‹å‰å…ˆè¯•è¯• unknownï¼Ÿ"}},"next":null,"translations":[],"translatedLinks":[]}},"staticQueryHashes":["336482444"]}